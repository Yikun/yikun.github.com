<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>Build/check report for BioC 3.17 - CHECK results for genomeIntervals on kunpeng1</TITLE>
<LINK rel="stylesheet" href="../report.css" type="text/css">
<SCRIPT type="text/javascript" src="../report.js"></SCRIPT>
</HEAD>
<BODY onLoad="initialize();">
<TABLE class="grid_layout" style="width: 100%; background: #EEE;"><TR><TD style="text-align: left; padding: 5px; vertical-align: middle;"><I><A href="../index.html">Back to <B>Build/check report for BioC 3.17</B></A></I></TD><TD><TABLE class="abc_dispatcher"><TR><TD><A href="../index.html#A">A</A></TD><TD><A href="../index.html#B">B</A></TD><TD><A href="../index.html#C">C</A></TD><TD><A href="../index.html#D">D</A></TD><TD><A href="../index.html#E">E</A></TD><TD><A href="../index.html#F">F</A></TD><TD><B>[<A href="../index.html#G">G</A>]</B></TD><TD><A href="../index.html#H">H</A></TD><TD><A href="../index.html#I">I</A></TD><TD><A href="../index.html#J">J</A></TD><TD><A href="../index.html#K">K</A></TD><TD><A href="../index.html#L">L</A></TD><TD><A href="../index.html#M">M</A></TD><TD><A href="../index.html#N">N</A></TD><TD><A href="../index.html#O">O</A></TD><TD><A href="../index.html#P">P</A></TD><TD><A href="../index.html#Q">Q</A></TD><TD><A href="../index.html#R">R</A></TD><TD><A href="../index.html#S">S</A></TD><TD><A href="../index.html#T">T</A></TD><TD><A href="../index.html#U">U</A></TD><TD><A href="../index.html#V">V</A></TD><TD><A href="../index.html#W">W</A></TD><TD><A href="../index.html#X">X</A></TD><TD><A href="../index.html#Y">Y</A></TD><TD><A href="../index.html#Z">Z</A></TD></TR></TABLE></TD></TR></TABLE>
<P class="time_stamp">
This page was generated on 2023-02-13 06:49:30 -0000 (Mon, 13 Feb 2023).
</P>
<TABLE class="node_specs">
<TR><TH>Hostname</TH><TH>OS</TH><TH>Arch&nbsp;(*)</TH><TH>R&nbsp;version</TH><TH style="text-align: right;">Installed&nbsp;pkgs</TH></TR>
<TR class="kunpeng1"><TD><B><A href="../kunpeng1-NodeInfo.html"><B>kunpeng1</B></A></B></TD><TD>Linux&nbsp;(Ubuntu&nbsp;22.04.1&nbsp;LTS)</TD><TD>aarch64</TD><TD>R&nbsp;Under&nbsp;development&nbsp;(unstable)&nbsp;(2023-01-14&nbsp;r83615)&nbsp;--&nbsp;"Unsuffered&nbsp;Consequences"
</TD><TD style="text-align: right;"><A href="../kunpeng1-R-instpkgs.html">4222</A></TD></TR>
<TR><TD COLSPAN="5" style="font-size: smaller;"><I>Click on any hostname to see more info about the system (e.g. compilers) &nbsp;&nbsp;&nbsp;&nbsp; (*) as reported by 'uname -p', except on Windows and Mac OS X</I></TD></TR>
</TABLE>
<BR>
<H2><SPAN class="kunpeng1">CHECK results for genomeIntervals on kunpeng1</SPAN></H2>
<BR>
<DIV class="motd">
<TABLE><TR><TD>
To the developers/maintainers of the genomeIntervals package:<BR>
- Please allow up to 24 hours (and sometimes 48 hours) for your latest push to git@git.bioconductor.org:packages/genomeIntervals.git to<BR>reflect on this report. See <A href="https://bioconductor.org/developers/how-to/troubleshoot-build-report/">How and When does the builder pull? When will my changes propagate?</A> for more information.<BR>
- Make sure to <A href="../Renviron.bioc">use the following settings</A> in order to reproduce any error or warning you see on this page.<BR>
</TD></TR></TABLE>
</DIV>
<P style="text-align: center;"><A href="raw-results/">raw results</A><P>
<TABLE class="gcard_list">
<TBODY class="gcard warnings">
<TR class="header"><TD class="leftmost top_left_corner"></TD><TD>Package <B>769</B>/2164</TD><TD style="width: 75px;">Hostname</TD><TD style="width: 225px;">OS&nbsp;/&nbsp;Arch</TD><TD class="STAGE install">INSTALL</TD><TD class="STAGE buildsrc">BUILD</TD><TD class="STAGE checksrc selected">CHECK</TD><TD class="STAGE buildbin">BUILD BIN</TD><TD style="width: 12px;"></TD><TD class="rightmost top_right_corner"></TD></TR>
<TR class="selected_row"><TD ROWSPAN="2" class="leftmost bottom_left_corner"></TD><TD ROWSPAN="1" style="vertical-align: top;"><B><A href="./">genomeIntervals</A>&nbsp;1.55.0</B>&nbsp;&nbsp;<SPAN style="font-size: smaller; font-style: italic;">(<A href="/packages/3.17/genomeIntervals">landing page</A>)</SPAN><BR>Julien Gagneur<BR><TABLE class="svn_info">
<TR><TD class="svn_info">Snapshot&nbsp;Date:&nbsp;<SPAN class="svn_info">2023-02-11&nbsp;01:58:29&nbsp;-0000&nbsp;(Sat,&nbsp;11&nbsp;Feb&nbsp;2023)</SPAN></TD></TR>
<TR><TD class="svn_info">git_url:&nbsp;<SPAN class="svn_info">https://git.bioconductor.org/packages/genomeIntervals</SPAN></TD></TR>
<TR><TD class="svn_info">git_branch:&nbsp;<SPAN class="svn_info">master</SPAN></TD></TR>
<TR><TD class="svn_info">git_last_commit:&nbsp;<SPAN class="svn_info">65437b0</SPAN></TD></TR>
<TR><TD class="svn_info">git_last_commit_date:&nbsp;<SPAN class="svn_info">2022-11-01&nbsp;15:04:21&nbsp;-0000&nbsp;(Tue,&nbsp;01&nbsp;Nov&nbsp;2022)</SPAN></TD></TR>
</TABLE>
</TD><TD class="kunpeng1 selected"><B>kunpeng1</B></TD><TD class="kunpeng1"><SPAN style="font-size: smaller;">Linux&nbsp;(Ubuntu&nbsp;22.04.1&nbsp;LTS)&nbsp;/&nbsp;aarch64</SPAN></TD><TD class="status kunpeng1 install"><A href="./kunpeng1-install.html" onmouseover="add_class_mouseover(this);" onmouseout="remove_class_mouseover(this);"><SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></A></TD><TD class="status kunpeng1 buildsrc"><A href="./kunpeng1-buildsrc.html" onmouseover="add_class_mouseover(this);" onmouseout="remove_class_mouseover(this);"><SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></A></TD><TD class="status kunpeng1 checksrc selected"><A href="./kunpeng1-checksrc.html" onmouseover="add_class_mouseover(this);" onmouseout="remove_class_mouseover(this);"><SPAN class="glyph WARNINGS">&nbsp;&nbsp;WARNINGS&nbsp;&nbsp;</SPAN></A></TD><TD class="status kunpeng1"></TD><TD class="status kunpeng1"></TD><TD ROWSPAN="2" class="rightmost bottom_right_corner"></TD></TR>
<TR class="footer"><TD COLSPAN="8"></TD></TR>
</TBODY>
</TABLE>
<HR>
<H3>Summary</H3>
<DIV class="kunpeng1 hscrollable">
<TABLE>
<TR><TD><B>Package</B>: genomeIntervals</TD></TR>
<TR><TD><B>Version</B>: 1.55.0</TD></TR>
<TR><TD><B>Command</B>: /home/biocbuild/bbs-3.17-bioc/R/bin/R CMD check --install=check:genomeIntervals.install-out.txt --library=/home/biocbuild/bbs-3.17-bioc/R/library --timings genomeIntervals_1.55.0.tar.gz</TD></TR>
<TR><TD><B>StartedAt</B>: 2023-02-11 15:12:00 -0000 (Sat, 11 Feb 2023)</TD></TR>
<TR><TD><B>EndedAt</B>: 2023-02-11 15:14:10 -0000 (Sat, 11 Feb 2023)</TD></TR>
<TR><TD><B>EllapsedTime</B>: 130.2 seconds</TD></TR>
<TR><TD><B>RetCode</B>: 0</TD></TR>
<TR><TD><B>Status</B>: <SPAN class="glyph WARNINGS">&nbsp;&nbsp;WARNINGS&nbsp;&nbsp;</SPAN></TD></TR>
<TR><TD><B>CheckDir</B>: genomeIntervals.Rcheck</TD></TR>
<TR><TD><B>Warnings</B>: 1</TD></TR>
</TABLE>
</DIV>
<HR>
<H3>Command output</H3>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">
##############################################################################
##############################################################################
###
### Running command:
###
###   /home/biocbuild/bbs-3.17-bioc/R/bin/R CMD check --install=check:genomeIntervals.install-out.txt --library=/home/biocbuild/bbs-3.17-bioc/R/library --timings genomeIntervals_1.55.0.tar.gz
###
##############################################################################
##############################################################################


* using log directory ‘/home/biocbuild/bbs-3.17-bioc/meat/genomeIntervals.Rcheck’
* using R Under development (unstable) (2023-01-14 r83615)
* using platform: aarch64-unknown-linux-gnu (64-bit)
* R was compiled by
    gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0
    GNU Fortran (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0
* running under: Ubuntu 22.04.1 LTS
* using session charset: UTF-8
* checking for file ‘genomeIntervals/DESCRIPTION’ ... OK
* checking extension type ... Package
* this is package ‘genomeIntervals’ version ‘1.55.0’
* package encoding: UTF-8
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking for sufficient/correct file permissions ... OK
* checking whether package ‘genomeIntervals’ can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking ‘build’ directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies ... OK
* checking whether the package can be unloaded cleanly ... OK
* checking whether the namespace can be loaded with stated dependencies ... OK
* checking whether the namespace can be unloaded cleanly ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... WARNING
checkRd: (-1) Genome_intervals-class.Rd:42: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:66: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:67: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:68: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:69: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:70: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:77: Escaped LaTeX specials: \$
checkRd: (-1) Genome_intervals-class.Rd:78: Escaped LaTeX specials: \$
checkRd: (-1) Genome_intervals-class.Rd:86: Escaped LaTeX specials: \_ \_
checkRd: (-1) Genome_intervals-class.Rd:87: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:88: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:89: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:90: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:91: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:92: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals-class.Rd:97: Escaped LaTeX specials: \_
checkRd: (5) Genome_intervals-ordering.Rd:75-82: \item in \describe must have non-empty label
checkRd: (5) Genome_intervals-ordering.Rd:83-87: \item in \describe must have non-empty label
checkRd: (5) Genome_intervals-ordering.Rd:88-92: \item in \describe must have non-empty label
checkRd: (5) Genome_intervals-ordering.Rd:93-98: \item in \describe must have non-empty label
checkRd: (-1) Genome_intervals_stranded-class.Rd:12: Escaped LaTeX specials: \_ \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:26: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:27: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:28: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:29: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:30: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:31: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:36: Escaped LaTeX specials: \_ \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:37: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:38: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:39: Escaped LaTeX specials: \_
checkRd: (-1) Genome_intervals_stranded-class.Rd:40: Escaped LaTeX specials: \_
checkRd: (-1) genomeIntervals-package.Rd:32: Escaped LaTeX specials: \_
checkRd: (-1) genomeIntervals-package.Rd:33: Escaped LaTeX specials: \_ \_
checkRd: (-1) interval_overlap-methods.Rd:37: Escaped LaTeX specials: \_
checkRd: (-1) parseGffAttributes.Rd:5: Escaped LaTeX specials: \_
* checking Rd metadata ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking contents of ‘data’ directory ... OK
* checking data for non-ASCII characters ... OK
* checking data for ASCII and uncompressed saves ... OK
* checking files in ‘vignettes’ ... OK
* checking examples ... OK
* checking for unstated dependencies in ‘tests’ ... OK
* checking tests ...
  Running ‘benchmarking-tests.R’
  Comparing ‘benchmarking-tests.Rout’ to ‘benchmarking-tests.Rout.save’ ...15a16,21
&gt; The following objects are masked from &#x27;package:parallel&#x27;:
&gt; 
&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,
&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB
&gt; 
26c32
&lt;     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
---
&gt;     Filter, Find, Map, Position, Reduce, anyDuplicated, append,
31c37
&lt;     tapply, union, unique, unsplit, which.max, which.min
---
&gt;     tapply, union, unique, unsplit, which, which.max, which.min
  Running ‘consistency-tests.R’
  Comparing ‘consistency-tests.Rout’ to ‘consistency-tests.Rout.save’ ...12a13,18
&gt; The following objects are masked from &#x27;package:parallel&#x27;:
&gt; 
&gt;     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
&gt;     clusterExport, clusterMap, parApply, parCapply, parLapply,
&gt;     parLapplyLB, parRapply, parSapply, parSapplyLB
&gt; 
23c29
&lt;     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
---
&gt;     Filter, Find, Map, Position, Reduce, anyDuplicated, append,
28c34
&lt;     tapply, union, unique, unsplit, which.max, which.min
---
&gt;     tapply, union, unique, unsplit, which, which.max, which.min
  Running ‘fullShow.R’
 OK
* checking for unstated dependencies in vignettes ... OK
* checking package vignettes in ‘inst/doc’ ... OK
* checking running R code from vignettes ...
  ‘genomeIntervals.Rnw’ using ‘UTF-8’... OK
 OK
* checking re-building of vignette outputs ... OK
* checking PDF version of manual ... OK
* DONE

Status: 1 WARNING
See
  ‘/home/biocbuild/bbs-3.17-bioc/meat/genomeIntervals.Rcheck/00check.log’
for details.


</PRE>
</DIV><HR>
<H3>Installation output</H3>
<P><SPAN class="filename">genomeIntervals.Rcheck/00install.out</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">
##############################################################################
##############################################################################
###
### Running command:
###
###   /home/biocbuild/bbs-3.17-bioc/R/bin/R CMD INSTALL genomeIntervals
###
##############################################################################
##############################################################################


* installing to library ‘/home/biocbuild/bbs-3.17-bioc/R/library’
* installing *source* package ‘genomeIntervals’ ...
** using staged installation
** R
** data
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (genomeIntervals)
</PRE>
</DIV><HR>
<H3>Tests output</H3>
<P><SPAN class="filename">genomeIntervals.Rcheck/tests/benchmarking-tests.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R Under development (unstable) (2023-01-14 r83615) -- &quot;Unsuffered Consequences&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; # benchmarking tests
&gt; # 
&gt; # on modifications, regenerate .Rout.save with:
&gt; # R --vanilla &lt;./benchmarking-tests.R &gt;&amp; ./benchmarking-tests.Rout.save
&gt; # and use svn&#x27; diff to check for differences
&gt; #
&gt; # Author: julien.gagneur
&gt; ###############################################################################
&gt; 
&gt; library(genomeIntervals)
Loading required package: intervals
Loading required package: BiocGenerics

Attaching package: &#x27;BiocGenerics&#x27;

The following objects are masked from &#x27;package:intervals&#x27;:

    type, type&lt;-

The following objects are masked from &#x27;package:stats&#x27;:

    IQR, mad, sd, var, xtabs

The following objects are masked from &#x27;package:base&#x27;:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min

&gt; source(&quot;fullShow.R&quot;)
&gt; options(warn = -1)
&gt; 
&gt; #---------------
&gt; # make data
&gt; #---------------
&gt; # toy examples
&gt; data(&quot;gen_ints&quot;)
&gt; 
&gt; # non-stranded versions
&gt; i0 = as(i, &quot;Genome_intervals&quot;)
&gt; j0 = as(j, &quot;Genome_intervals&quot;)
&gt; k0 = as(k, &quot;Genome_intervals&quot;)
&gt; 
&gt; # empty intervals
&gt; e = k[1:3,]
&gt; e[,2] = e[,1]
&gt; closed(e) = FALSE
&gt; 
&gt; #---------------
&gt; # checks
&gt; #---------------
&gt; # distance to nearest
&gt; cat(&quot;distance_to_nearest\n&quot;)
distance_to_nearest
&gt; print( distance_to_nearest(i,j) )		# x
[1]  0  2  3  0  0  0 NA
&gt; print( distance_to_nearest(j,i) )		# x
[1]  0  2 NA  0  0
&gt; print( distance_to_nearest(i,k) )		# x
[1] 0.0 1.5 2.5 0.5 0.0 0.0  NA
&gt; print( distance_to_nearest(i,e) )		# x
[1] NA NA NA NA NA NA NA
&gt; print( distance_to_nearest(e,i) )		# x
[1] NA NA NA
&gt; 
&gt; print( distance_to_nearest(i0,j0) )		# x
[1]  0  0  1  0  0  0 NA
&gt; print( distance_to_nearest(j0,i0) )		# x
[1] 0 2 0 0 0
&gt; cat(&quot;\n&quot;)

&gt; 
&gt; # interval overlap
&gt; cat(&quot;interval_overlap\n&quot;)
interval_overlap
&gt; print( interval_overlap(i,k) )			# x
[[1]]
[1] 1

[[2]]
integer(0)

[[3]]
integer(0)

[[4]]
integer(0)

[[5]]
[1] 5

[[6]]
[1] 4

[[7]]
integer(0)

&gt; print( interval_overlap(i,e) )			# x
[[1]]
integer(0)

[[2]]
integer(0)

[[3]]
integer(0)

[[4]]
integer(0)

[[5]]
integer(0)

[[6]]
integer(0)

[[7]]
integer(0)

&gt; print( interval_overlap(i0,j0) )		# x
[[1]]
[1] 1

[[2]]
[1] 3

[[3]]
integer(0)

[[4]]
[1] 5

[[5]]
[1] 5

[[6]]
[1] 4 5

[[7]]
integer(0)

&gt; cat(&quot;\n&quot;)

&gt; 
&gt; 
&gt; # set operations
&gt; cat(&quot;interval_union\n&quot;)
interval_union
&gt; fullShow( close_intervals( interval_union(i) ) )		# x
Object of class Genome_intervals_stranded
4 base intervals and 0 inter-base intervals(*):
chr01 + [1, 4] 
chr02 + [4, 12] 
chr03 + [2, 5] 
chr02 - [5, 11] 
annotation:
  seq_name inter_base strand
1    chr01      FALSE      +
2    chr02      FALSE      +
3    chr03      FALSE      +
4    chr02      FALSE      -
&gt; fullShow( close_intervals( interval_union(i,k) ) )		# x
Object of class Genome_intervals_stranded
6 base intervals and 2 inter-base intervals(*):
chr01 + [1, 4] 
chr01 + [6, 10] 
chr01 + [1, 1] *
chr02 + [4, 15] 
chr03 + [2, 5] 
chr01 - [4, 5] 
chr02 - [5, 11] 
chr02 - [8, 8] *
annotation:
  seq_name inter_base strand
1    chr01      FALSE      +
2    chr01      FALSE      +
3    chr01       TRUE      +
4    chr02      FALSE      +
5    chr03      FALSE      +
6    chr01      FALSE      -
7    chr02      FALSE      -
8    chr02       TRUE      -
&gt; fullShow( close_intervals( interval_union(i0,k0) ) )	# x
Object of class Genome_intervals
3 base intervals and 2 inter-base intervals(*):
chr01 [1, 10] 
chr01 [1, 1] *
chr02 [4, 15] 
chr02 [8, 8] *
chr03 [2, 5] 
annotation:
  inter_base seq_name
1      FALSE    chr01
2       TRUE    chr01
3      FALSE    chr02
4       TRUE    chr02
5      FALSE    chr03
&gt; fullShow( close_intervals( interval_union(e) ) )		# x
Object of class Genome_intervals_stranded
0 base intervals and 0 inter-base intervals(*):

annotation:
[1] seq_name   inter_base strand    
&lt;0 rows&gt; (or 0-length row.names)
&gt; cat(&quot;\n&quot;)

&gt; 
&gt; cat(&quot;interval_intersection\n&quot;)
interval_intersection
&gt; fullShow( close_intervals( interval_intersection(i,j) ) ) # x
Object of class Genome_intervals_stranded
3 base intervals and 0 inter-base intervals(*):
chr01 + [1, 1] 
chr02 - [8, 8] 
chr02 + [12, 12] 
annotation:
  inter_base seq_name strand
1      FALSE    chr01      +
2      FALSE    chr02      -
3      FALSE    chr02      +
&gt; fullShow( close_intervals( interval_intersection(i,k) ) ) # x
Object of class Genome_intervals_stranded
1 base interval and 0 inter-base intervals(*):
chr02 + [12, 12] 
annotation:
  inter_base seq_name strand
1      FALSE    chr02      +
&gt; fullShow( close_intervals( interval_intersection(i,e) ) ) # x
Object of class Genome_intervals_stranded
0 base intervals and 0 inter-base intervals(*):

annotation:
[1] inter_base seq_name   strand    
&lt;0 rows&gt; (or 0-length row.names)
&gt; cat(&quot;\n&quot;)

&gt; 
&gt; cat(&quot;interval_complement\n&quot;)
interval_complement
&gt; fullShow( close_intervals( interval_complement(j) ) )	# x
Object of class Genome_intervals_stranded
9 base intervals and 0 inter-base intervals(*):
chr01 + [-Inf, 0] 
chr01 + [2, 5] 
chr01 + [11, Inf] 
chr02 + [-Inf, 11] 
chr02 + [16, Inf] 
chr01 - [-Inf, 3] 
chr01 - [6, Inf] 
chr02 - [-Inf, 7] 
chr02 - [9, Inf] 
annotation:
  seq_name inter_base strand
1    chr01      FALSE      +
2    chr01      FALSE      +
3    chr01      FALSE      +
4    chr02      FALSE      +
5    chr02      FALSE      +
6    chr01      FALSE      -
7    chr01      FALSE      -
8    chr02      FALSE      -
9    chr02      FALSE      -
&gt; fullShow( close_intervals( interval_complement(j0) ) )	# x
Object of class Genome_intervals
6 base intervals and 0 inter-base intervals(*):
chr01 [-Inf, 0] 
chr01 [2, 3] 
chr01 [11, Inf] 
chr02 [-Inf, 7] 
chr02 [9, 11] 
chr02 [16, Inf] 
annotation:
  inter_base seq_name
1      FALSE    chr01
2      FALSE    chr01
3      FALSE    chr01
4      FALSE    chr02
5      FALSE    chr02
6      FALSE    chr02
&gt; fullShow( close_intervals( interval_complement(k) ) ) # x
Object of class Genome_intervals_stranded
7 base intervals and 6 inter-base intervals(*):
chr01 + [-Inf, 5] 
chr01 + [11, Inf] 
chr01 + [-Inf, 0] *
chr01 + [2, Inf] *
chr02 + [-Inf, 11] 
chr02 + [16, Inf] 
chr02 + [-Inf, Inf] *
chr01 - [-Inf, 3] 
chr01 - [6, Inf] 
chr01 - [-Inf, Inf] *
chr02 - [-Inf, Inf] 
chr02 - [-Inf, 7] *
chr02 - [9, Inf] *
annotation:
   seq_name inter_base strand
1     chr01      FALSE      +
2     chr01      FALSE      +
3     chr01       TRUE      +
4     chr01       TRUE      +
5     chr02      FALSE      +
6     chr02      FALSE      +
7     chr02       TRUE      +
8     chr01      FALSE      -
9     chr01      FALSE      -
10    chr01       TRUE      -
11    chr02      FALSE      -
12    chr02       TRUE      -
13    chr02       TRUE      -
&gt; fullShow( close_intervals( interval_complement(e) ) ) # x
Object of class Genome_intervals_stranded
4 base intervals and 2 inter-base intervals(*):
chr01 + [-Inf, Inf] 
chr01 + [-Inf, Inf] *
chr02 + [-Inf, Inf] 
chr02 + [-Inf, Inf] *
chr01 - [-Inf, Inf] 
chr02 - [-Inf, Inf] 
annotation:
  seq_name inter_base strand
1    chr01      FALSE      +
2    chr01       TRUE      +
3    chr02      FALSE      +
4    chr02       TRUE      +
5    chr01      FALSE      -
6    chr02      FALSE      -
&gt; cat(&quot;\n&quot;)

&gt; 
&gt; 
&gt; proc.time()
   user  system elapsed 
  6.053   0.261   6.297 
</PRE>
</DIV><P><SPAN class="filename">genomeIntervals.Rcheck/tests/benchmarking-tests.Rout.save</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.0.0 (2020-04-24) -- &quot;Arbor Day&quot;
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin17.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; # benchmarking tests
&gt; # 
&gt; # on modifications, regenerate .Rout.save with:
&gt; # R --vanilla &lt;./benchmarking-tests.R &gt;&amp; ./benchmarking-tests.Rout.save
&gt; # and use svn&#x27; diff to check for differences
&gt; #
&gt; # Author: julien.gagneur
&gt; ###############################################################################
&gt; 
&gt; library(genomeIntervals)
Loading required package: intervals
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: &#x27;BiocGenerics&#x27;

The following objects are masked from &#x27;package:parallel&#x27;:

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following objects are masked from &#x27;package:intervals&#x27;:

    type, type&lt;-

The following objects are masked from &#x27;package:stats&#x27;:

    IQR, mad, sd, var, xtabs

The following objects are masked from &#x27;package:base&#x27;:

    Filter, Find, Map, Position, Reduce, anyDuplicated, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which, which.max, which.min

&gt; source(&quot;fullShow.R&quot;)
&gt; options(warn = -1)
&gt; 
&gt; #---------------
&gt; # make data
&gt; #---------------
&gt; # toy examples
&gt; data(&quot;gen_ints&quot;)
&gt; 
&gt; # non-stranded versions
&gt; i0 = as(i, &quot;Genome_intervals&quot;)
&gt; j0 = as(j, &quot;Genome_intervals&quot;)
&gt; k0 = as(k, &quot;Genome_intervals&quot;)
&gt; 
&gt; # empty intervals
&gt; e = k[1:3,]
&gt; e[,2] = e[,1]
&gt; closed(e) = FALSE
&gt; 
&gt; #---------------
&gt; # checks
&gt; #---------------
&gt; # distance to nearest
&gt; cat(&quot;distance_to_nearest\n&quot;)
distance_to_nearest
&gt; print( distance_to_nearest(i,j) )		# x
[1]  0  2  3  0  0  0 NA
&gt; print( distance_to_nearest(j,i) )		# x
[1]  0  2 NA  0  0
&gt; print( distance_to_nearest(i,k) )		# x
[1] 0.0 1.5 2.5 0.5 0.0 0.0  NA
&gt; print( distance_to_nearest(i,e) )		# x
[1] NA NA NA NA NA NA NA
&gt; print( distance_to_nearest(e,i) )		# x
[1] NA NA NA
&gt; 
&gt; print( distance_to_nearest(i0,j0) )		# x
[1]  0  0  1  0  0  0 NA
&gt; print( distance_to_nearest(j0,i0) )		# x
[1] 0 2 0 0 0
&gt; cat(&quot;\n&quot;)

&gt; 
&gt; # interval overlap
&gt; cat(&quot;interval_overlap\n&quot;)
interval_overlap
&gt; print( interval_overlap(i,k) )			# x
[[1]]
[1] 1

[[2]]
integer(0)

[[3]]
integer(0)

[[4]]
integer(0)

[[5]]
[1] 5

[[6]]
[1] 4

[[7]]
integer(0)

&gt; print( interval_overlap(i,e) )			# x
[[1]]
integer(0)

[[2]]
integer(0)

[[3]]
integer(0)

[[4]]
integer(0)

[[5]]
integer(0)

[[6]]
integer(0)

[[7]]
integer(0)

&gt; print( interval_overlap(i0,j0) )		# x
[[1]]
[1] 1

[[2]]
[1] 3

[[3]]
integer(0)

[[4]]
[1] 5

[[5]]
[1] 5

[[6]]
[1] 4 5

[[7]]
integer(0)

&gt; cat(&quot;\n&quot;)

&gt; 
&gt; 
&gt; # set operations
&gt; cat(&quot;interval_union\n&quot;)
interval_union
&gt; fullShow( close_intervals( interval_union(i) ) )		# x
Object of class Genome_intervals_stranded
4 base intervals and 0 inter-base intervals(*):
chr01 + [1, 4] 
chr02 + [4, 12] 
chr03 + [2, 5] 
chr02 - [5, 11] 
annotation:
  seq_name inter_base strand
1    chr01      FALSE      +
2    chr02      FALSE      +
3    chr03      FALSE      +
4    chr02      FALSE      -
&gt; fullShow( close_intervals( interval_union(i,k) ) )		# x
Object of class Genome_intervals_stranded
6 base intervals and 2 inter-base intervals(*):
chr01 + [1, 4] 
chr01 + [6, 10] 
chr01 + [1, 1] *
chr02 + [4, 15] 
chr03 + [2, 5] 
chr01 - [4, 5] 
chr02 - [5, 11] 
chr02 - [8, 8] *
annotation:
  seq_name inter_base strand
1    chr01      FALSE      +
2    chr01      FALSE      +
3    chr01       TRUE      +
4    chr02      FALSE      +
5    chr03      FALSE      +
6    chr01      FALSE      -
7    chr02      FALSE      -
8    chr02       TRUE      -
&gt; fullShow( close_intervals( interval_union(i0,k0) ) )	# x
Object of class Genome_intervals
3 base intervals and 2 inter-base intervals(*):
chr01 [1, 10] 
chr01 [1, 1] *
chr02 [4, 15] 
chr02 [8, 8] *
chr03 [2, 5] 
annotation:
  inter_base seq_name
1      FALSE    chr01
2       TRUE    chr01
3      FALSE    chr02
4       TRUE    chr02
5      FALSE    chr03
&gt; fullShow( close_intervals( interval_union(e) ) )		# x
Object of class Genome_intervals_stranded
0 base intervals and 0 inter-base intervals(*):

annotation:
[1] seq_name   inter_base strand    
&lt;0 rows&gt; (or 0-length row.names)
&gt; cat(&quot;\n&quot;)

&gt; 
&gt; cat(&quot;interval_intersection\n&quot;)
interval_intersection
&gt; fullShow( close_intervals( interval_intersection(i,j) ) ) # x
Object of class Genome_intervals_stranded
3 base intervals and 0 inter-base intervals(*):
chr01 + [1, 1] 
chr02 - [8, 8] 
chr02 + [12, 12] 
annotation:
  inter_base seq_name strand
1      FALSE    chr01      +
2      FALSE    chr02      -
3      FALSE    chr02      +
&gt; fullShow( close_intervals( interval_intersection(i,k) ) ) # x
Object of class Genome_intervals_stranded
1 base interval and 0 inter-base intervals(*):
chr02 + [12, 12] 
annotation:
  inter_base seq_name strand
1      FALSE    chr02      +
&gt; fullShow( close_intervals( interval_intersection(i,e) ) ) # x
Object of class Genome_intervals_stranded
0 base intervals and 0 inter-base intervals(*):

annotation:
[1] inter_base seq_name   strand    
&lt;0 rows&gt; (or 0-length row.names)
&gt; cat(&quot;\n&quot;)

&gt; 
&gt; cat(&quot;interval_complement\n&quot;)
interval_complement
&gt; fullShow( close_intervals( interval_complement(j) ) )	# x
Object of class Genome_intervals_stranded
9 base intervals and 0 inter-base intervals(*):
chr01 + [-Inf, 0] 
chr01 + [2, 5] 
chr01 + [11, Inf] 
chr02 + [-Inf, 11] 
chr02 + [16, Inf] 
chr01 - [-Inf, 3] 
chr01 - [6, Inf] 
chr02 - [-Inf, 7] 
chr02 - [9, Inf] 
annotation:
  seq_name inter_base strand
1    chr01      FALSE      +
2    chr01      FALSE      +
3    chr01      FALSE      +
4    chr02      FALSE      +
5    chr02      FALSE      +
6    chr01      FALSE      -
7    chr01      FALSE      -
8    chr02      FALSE      -
9    chr02      FALSE      -
&gt; fullShow( close_intervals( interval_complement(j0) ) )	# x
Object of class Genome_intervals
6 base intervals and 0 inter-base intervals(*):
chr01 [-Inf, 0] 
chr01 [2, 3] 
chr01 [11, Inf] 
chr02 [-Inf, 7] 
chr02 [9, 11] 
chr02 [16, Inf] 
annotation:
  inter_base seq_name
1      FALSE    chr01
2      FALSE    chr01
3      FALSE    chr01
4      FALSE    chr02
5      FALSE    chr02
6      FALSE    chr02
&gt; fullShow( close_intervals( interval_complement(k) ) ) # x
Object of class Genome_intervals_stranded
7 base intervals and 6 inter-base intervals(*):
chr01 + [-Inf, 5] 
chr01 + [11, Inf] 
chr01 + [-Inf, 0] *
chr01 + [2, Inf] *
chr02 + [-Inf, 11] 
chr02 + [16, Inf] 
chr02 + [-Inf, Inf] *
chr01 - [-Inf, 3] 
chr01 - [6, Inf] 
chr01 - [-Inf, Inf] *
chr02 - [-Inf, Inf] 
chr02 - [-Inf, 7] *
chr02 - [9, Inf] *
annotation:
   seq_name inter_base strand
1     chr01      FALSE      +
2     chr01      FALSE      +
3     chr01       TRUE      +
4     chr01       TRUE      +
5     chr02      FALSE      +
6     chr02      FALSE      +
7     chr02       TRUE      +
8     chr01      FALSE      -
9     chr01      FALSE      -
10    chr01       TRUE      -
11    chr02      FALSE      -
12    chr02       TRUE      -
13    chr02       TRUE      -
&gt; fullShow( close_intervals( interval_complement(e) ) ) # x
Object of class Genome_intervals_stranded
4 base intervals and 2 inter-base intervals(*):
chr01 + [-Inf, Inf] 
chr01 + [-Inf, Inf] *
chr02 + [-Inf, Inf] 
chr02 + [-Inf, Inf] *
chr01 - [-Inf, Inf] 
chr02 - [-Inf, Inf] 
annotation:
  seq_name inter_base strand
1    chr01      FALSE      +
2    chr01       TRUE      +
3    chr02      FALSE      +
4    chr02       TRUE      +
5    chr01      FALSE      -
6    chr02      FALSE      -
&gt; cat(&quot;\n&quot;)

&gt; 
&gt; 
&gt; proc.time()
   user  system elapsed 
  3.697   0.178   3.876 
</PRE>
</DIV><P><SPAN class="filename">genomeIntervals.Rcheck/tests/consistency-tests.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R Under development (unstable) (2023-01-14 r83615) -- &quot;Unsuffered Consequences&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; # consistency test
&gt; #
&gt; # Author: julien.gagneur
&gt; ###############################################################################
&gt; 
&gt; 
&gt; library( genomeIntervals )
Loading required package: intervals
Loading required package: BiocGenerics

Attaching package: &#x27;BiocGenerics&#x27;

The following objects are masked from &#x27;package:intervals&#x27;:

    type, type&lt;-

The following objects are masked from &#x27;package:stats&#x27;:

    IQR, mad, sd, var, xtabs

The following objects are masked from &#x27;package:base&#x27;:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min

&gt; 
&gt; options(warn = -1)
&gt; 
&gt; #---------
&gt; # settings
&gt; #---------
&gt; # size of random objects
&gt; n = 1e+3
&gt; # chrom length
&gt; l = 1e+3
&gt; # nb of chroms
&gt; k = 3
&gt; 
&gt; #---------
&gt; # data generation
&gt; #---------
&gt; 
&gt; randGenint = function(n,l,k){
+     m = matrix( sample(l, 2*n, replace=TRUE), nc = 2 )
+     m = cbind( apply( m, 1, min), apply( m, 1, max ) )
+ 
+     cl = matrix( sample( c(FALSE,TRUE), 2*n, replace =TRUE), nc=2 )
+     new(
+         &quot;Genome_intervals_stranded&quot;,
+         m,
+         closed = cl,
+         annotation = data.frame(
+                 seq_name = factor(paste(&quot;chr&quot;, sample(k, n, replace=TRUE) )),
+                 inter_base = sample( c(FALSE,TRUE), n, replace =TRUE),
+                 strand = factor(sample(c(&quot;-&quot;, &quot;+&quot;), n, replace =TRUE))
+         )
+     )
+ }
&gt; 
&gt; i = randGenint(n,l,k)
&gt; j = randGenint(n,l,k)
&gt; i0 = as(i, &quot;Genome_intervals&quot;)
&gt; j0 = as(j, &quot;Genome_intervals&quot;)
&gt; 
&gt; #---------
&gt; # checks
&gt; #---------
&gt; 
&gt; # distances from i to j
&gt; dn = distance_to_nearest(i,j)
&gt; 
&gt; # distance is NA or &gt;=0
&gt; if( any( !is.na(dn) &amp; dn &lt; 0) ) stop(&quot;negative distance.&quot;)
&gt; 
&gt; # distance == 0 if and only if the interval overlaps another one:
&gt; io = interval_overlap(i,j)
&gt; if( any( ( sapply(io, length) &gt;0 )  != (!is.na(dn) &amp; dn ==0) ) )
+     stop(&quot;The property &#x27;distance == 0 if and only if the interval overlaps another one&#x27; is not followed for at least one instance.&quot;)
&gt; 
&gt; # same test for not stranded objects
&gt; dn0 = distance_to_nearest(i0,j0)
&gt; if( any( !is.na(dn0) &amp; dn0 &lt; 0) ) stop(&quot;negative distance.&quot;)
&gt; 
&gt; io = interval_overlap(i0,j0)
&gt; if( any( ( sapply(io, length) &gt;0 )  != (!is.na(dn0) &amp; dn0 ==0) ) )
+     stop(&quot;The property &#x27;distance == 0 if and only if the interval overlaps another one&#x27; is not followed for at least one instance.&quot;)
&gt; 
&gt; # unstranded distance &lt;= stranded distance
&gt; delta = dn - dn0
&gt; if( any(!is.na(delta)  &amp; delta &lt; 0) ) stop(&quot;some unstranded distance larger than a stranded one.&quot;)
&gt; 
&gt; # intersection with complement is empty
&gt; stopifnot( nrow( interval_intersection(i, interval_complement(i) ) ) == 0 )
&gt; 
&gt; # distance of union with complement is 1
&gt; # test must be done for not inter-base (or inter-base) independently
&gt; a = interval_union(i[!inter_base(i),] )
&gt; b = interval_complement(i[!inter_base(i),])
&gt; 
&gt; if(!(all.equal( distance_to_nearest( a, b ), rep(1, nrow(a) )  ) ) )
+     stop(&quot;distance of union with complement is not 1.&quot;)
&gt; 
&gt; # width is reported consistently
&gt; # they should all be 4 in length (we alternate the open/closed state of the intervals
&gt; # pairwise)
&gt; gi &lt;- GenomeIntervals(start=c(6,6,5,5),
+                       end=c(10,9,10,9),
+                       chromosome=rep(&quot;chr1&quot;,4),
+                       leftOpen = c(FALSE,FALSE,TRUE,TRUE),
+                       rightOpen=c(TRUE,FALSE,TRUE,FALSE))
&gt; 
&gt; stopifnot(all(width(gi)==4))
&gt; 
&gt; proc.time()
   user  system elapsed 
  6.054   0.351   6.389 
</PRE>
</DIV><P><SPAN class="filename">genomeIntervals.Rcheck/tests/consistency-tests.Rout.save</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.0.0 (2020-04-24) -- &quot;Arbor Day&quot;
Copyright (C) 2020 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin17.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; # consistency test
&gt; #
&gt; # Author: julien.gagneur
&gt; ###############################################################################
&gt; 
&gt; 
&gt; library( genomeIntervals )
Loading required package: intervals
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: &#x27;BiocGenerics&#x27;

The following objects are masked from &#x27;package:parallel&#x27;:

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following objects are masked from &#x27;package:intervals&#x27;:

    type, type&lt;-

The following objects are masked from &#x27;package:stats&#x27;:

    IQR, mad, sd, var, xtabs

The following objects are masked from &#x27;package:base&#x27;:

    Filter, Find, Map, Position, Reduce, anyDuplicated, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which, which.max, which.min

&gt; 
&gt; options(warn = -1)
&gt; 
&gt; #---------
&gt; # settings
&gt; #---------
&gt; # size of random objects
&gt; n = 1e+3
&gt; # chrom length
&gt; l = 1e+3
&gt; # nb of chroms
&gt; k = 3
&gt; 
&gt; #---------
&gt; # data generation
&gt; #---------
&gt; 
&gt; randGenint = function(n,l,k){
+     m = matrix( sample(l, 2*n, replace=TRUE), nc = 2 )
+     m = cbind( apply( m, 1, min), apply( m, 1, max ) )
+ 
+     cl = matrix( sample( c(FALSE,TRUE), 2*n, replace =TRUE), nc=2 )
+     new(
+         &quot;Genome_intervals_stranded&quot;,
+         m,
+         closed = cl,
+         annotation = data.frame(
+                 seq_name = factor(paste(&quot;chr&quot;, sample(k, n, replace=TRUE) )),
+                 inter_base = sample( c(FALSE,TRUE), n, replace =TRUE),
+                 strand = factor(sample(c(&quot;-&quot;, &quot;+&quot;), n, replace =TRUE))
+         )
+     )
+ }
&gt; 
&gt; i = randGenint(n,l,k)
&gt; j = randGenint(n,l,k)
&gt; i0 = as(i, &quot;Genome_intervals&quot;)
&gt; j0 = as(j, &quot;Genome_intervals&quot;)
&gt; 
&gt; #---------
&gt; # checks
&gt; #---------
&gt; 
&gt; # distances from i to j
&gt; dn = distance_to_nearest(i,j)
&gt; 
&gt; # distance is NA or &gt;=0
&gt; if( any( !is.na(dn) &amp; dn &lt; 0) ) stop(&quot;negative distance.&quot;)
&gt; 
&gt; # distance == 0 if and only if the interval overlaps another one:
&gt; io = interval_overlap(i,j)
&gt; if( any( ( sapply(io, length) &gt;0 )  != (!is.na(dn) &amp; dn ==0) ) )
+     stop(&quot;The property &#x27;distance == 0 if and only if the interval overlaps another one&#x27; is not followed for at least one instance.&quot;)
&gt; 
&gt; # same test for not stranded objects
&gt; dn0 = distance_to_nearest(i0,j0)
&gt; if( any( !is.na(dn0) &amp; dn0 &lt; 0) ) stop(&quot;negative distance.&quot;)
&gt; 
&gt; io = interval_overlap(i0,j0)
&gt; if( any( ( sapply(io, length) &gt;0 )  != (!is.na(dn0) &amp; dn0 ==0) ) )
+     stop(&quot;The property &#x27;distance == 0 if and only if the interval overlaps another one&#x27; is not followed for at least one instance.&quot;)
&gt; 
&gt; # unstranded distance &lt;= stranded distance
&gt; delta = dn - dn0
&gt; if( any(!is.na(delta)  &amp; delta &lt; 0) ) stop(&quot;some unstranded distance larger than a stranded one.&quot;)
&gt; 
&gt; # intersection with complement is empty
&gt; stopifnot( nrow( interval_intersection(i, interval_complement(i) ) ) == 0 )
&gt; 
&gt; # distance of union with complement is 1
&gt; # test must be done for not inter-base (or inter-base) independently
&gt; a = interval_union(i[!inter_base(i),] )
&gt; b = interval_complement(i[!inter_base(i),])
&gt; 
&gt; if(!(all.equal( distance_to_nearest( a, b ), rep(1, nrow(a) )  ) ) )
+     stop(&quot;distance of union with complement is not 1.&quot;)
&gt; 
&gt; # width is reported consistently
&gt; # they should all be 4 in length (we alternate the open/closed state of the intervals
&gt; # pairwise)
&gt; gi &lt;- GenomeIntervals(start=c(6,6,5,5),
+                       end=c(10,9,10,9),
+                       chromosome=rep(&quot;chr1&quot;,4),
+                       leftOpen = c(FALSE,FALSE,TRUE,TRUE),
+                       rightOpen=c(TRUE,FALSE,TRUE,FALSE))
&gt; 
&gt; stopifnot(all(width(gi)==4))
&gt; 
&gt; proc.time()
   user  system elapsed 
  3.868   0.188   4.048 
</PRE>
</DIV><P><SPAN class="filename">genomeIntervals.Rcheck/tests/fullShow.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R Under development (unstable) (2023-01-14 r83615) -- &quot;Unsuffered Consequences&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; # the fullShow methods is a show method for Genome_intervals objects.
&gt; # It is called by test scripts so that the full output of the tests can be checked.  
&gt; # 
&gt; # Author: gagneur
&gt; ###############################################################################
&gt; 
&gt; fullShow &lt;- function(object ) {
+ 	cat(
+ 			&quot;Object of class &quot;,
+ 			class( object ),
+ 			&quot;\n&quot;,
+ 			sum( !inter_base(object) ),
+ 			&quot; base interval&quot;,
+ 			ifelse( sum( !inter_base(object) ) == 1, &quot;&quot;, &quot;s&quot; ),
+ 			&quot; and &quot;,
+ 			sum( inter_base(object) ),
+ 			&quot; inter-base interval&quot;,
+ 			ifelse( sum( inter_base(object) ) == 1, &quot;&quot;, &quot;s&quot; ),
+ 			&quot;(*)&quot;,
+ 			&quot;:\n&quot;,
+ 			sep = &quot;&quot;
+ 	)
+ 	ints &lt;- as( object, &quot;character&quot;)
+ 	if ( !is.null( rownames( object ) ) ) {
+ 		fmt &lt;- sprintf( &quot;%%%is&quot;, max( nchar( rownames( object ) ) ) )
+ 		ints &lt;- paste( sprintf( fmt, rownames( object ) ), ints )
+ 	}
+ 	cat( ints, sep = &quot;\n&quot; )
+ 	cat( &quot;annotation:\n&quot;)
+ 	show( annotation(object) )
+ }
&gt; 
&gt; 
&gt; 
&gt; 
&gt; proc.time()
   user  system elapsed 
  0.162   0.062   0.209 
</PRE>
</DIV><HR>
<H3>Example timings</H3>
<P><SPAN class="filename">genomeIntervals.Rcheck/genomeIntervals-Ex.timings</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<TABLE>
<TR><TD>name</TD><TD style="text-align: right;">user</TD><TD style="text-align: right;">system</TD><TD style="text-align: right;">elapsed
</TD><TR>
<TR><TD>GenomeIntervals-constructor</TD><TD style="text-align: right;">0.103</TD><TD style="text-align: right;">0.004</TD><TD style="text-align: right;">0.107</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>Genome_intervals-class</TD><TD style="text-align: right;">0.039</TD><TD style="text-align: right;">0.008</TD><TD style="text-align: right;">0.047</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>Genome_intervals-coercion-methods</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>Genome_intervals-ordering</TD><TD style="text-align: right;">0.067</TD><TD style="text-align: right;">0.008</TD><TD style="text-align: right;">0.075</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>Genome_intervals_stranded-class</TD><TD style="text-align: right;">0.062</TD><TD style="text-align: right;">0.008</TD><TD style="text-align: right;">0.070</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>c.Genome_intervals</TD><TD style="text-align: right;">0.090</TD><TD style="text-align: right;">0.012</TD><TD style="text-align: right;">0.102</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>core_annotated</TD><TD style="text-align: right;">0.058</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.058</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>distance_to_nearest-methods</TD><TD style="text-align: right;">0.277</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.277</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>genomeIntervals-readGff3</TD><TD style="text-align: right;">1.261</TD><TD style="text-align: right;">0.188</TD><TD style="text-align: right;">1.452</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>getGffAttribute</TD><TD style="text-align: right;">0.058</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.059</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>interval_overlap-methods</TD><TD style="text-align: right;">0.113</TD><TD style="text-align: right;">0.004</TD><TD style="text-align: right;">0.117</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>interval_set_operations-methods</TD><TD style="text-align: right;">0.675</TD><TD style="text-align: right;">0.008</TD><TD style="text-align: right;">0.683</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>parseGffAttributes</TD><TD style="text-align: right;">0.053</TD><TD style="text-align: right;">0.004</TD><TD style="text-align: right;">0.056</TD><TD style="text-align: right;">
</TD><TR>
</TABLE>
</DIV></BODY>
</HTML>
