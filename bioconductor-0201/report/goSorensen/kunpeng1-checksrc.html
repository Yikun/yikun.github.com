<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>Build/check report for BioC 3.17 - CHECK results for goSorensen on kunpeng1</TITLE>
<LINK rel="stylesheet" href="../report.css" type="text/css">
<SCRIPT type="text/javascript" src="../report.js"></SCRIPT>
</HEAD>
<BODY onLoad="initialize();">
<TABLE class="grid_layout" style="width: 100%; background: #EEE;"><TR><TD style="text-align: left; padding: 5px; vertical-align: middle;"><I><A href="../index.html">Back to <B>Build/check report for BioC 3.17</B></A></I></TD><TD><TABLE class="abc_dispatcher"><TR><TD><A href="../index.html#A">A</A></TD><TD><A href="../index.html#B">B</A></TD><TD><A href="../index.html#C">C</A></TD><TD><A href="../index.html#D">D</A></TD><TD><A href="../index.html#E">E</A></TD><TD><A href="../index.html#F">F</A></TD><TD><B>[<A href="../index.html#G">G</A>]</B></TD><TD><A href="../index.html#H">H</A></TD><TD><A href="../index.html#I">I</A></TD><TD><A href="../index.html#J">J</A></TD><TD><A href="../index.html#K">K</A></TD><TD><A href="../index.html#L">L</A></TD><TD><A href="../index.html#M">M</A></TD><TD><A href="../index.html#N">N</A></TD><TD><A href="../index.html#O">O</A></TD><TD><A href="../index.html#P">P</A></TD><TD><A href="../index.html#Q">Q</A></TD><TD><A href="../index.html#R">R</A></TD><TD><A href="../index.html#S">S</A></TD><TD><A href="../index.html#T">T</A></TD><TD><A href="../index.html#U">U</A></TD><TD><A href="../index.html#V">V</A></TD><TD><A href="../index.html#W">W</A></TD><TD><A href="../index.html#X">X</A></TD><TD><A href="../index.html#Y">Y</A></TD><TD><A href="../index.html#Z">Z</A></TD></TR></TABLE></TD></TR></TABLE>
<P class="time_stamp">
This page was generated on 2023-02-03 02:36:00 -0000 (Fri, 03 Feb 2023).
</P>
<TABLE class="node_specs">
<TR><TH>Hostname</TH><TH>OS</TH><TH>Arch&nbsp;(*)</TH><TH>R&nbsp;version</TH><TH style="text-align: right;">Installed&nbsp;pkgs</TH></TR>
<TR class="kunpeng1"><TD><B><A href="../kunpeng1-NodeInfo.html"><B>kunpeng1</B></A></B></TD><TD>Linux&nbsp;(Ubuntu&nbsp;22.04.1&nbsp;LTS)</TD><TD>aarch64</TD><TD>R&nbsp;Under&nbsp;development&nbsp;(unstable)&nbsp;(2023-01-14&nbsp;r83615)&nbsp;--&nbsp;"Unsuffered&nbsp;Consequences"
</TD><TD style="text-align: right;"><A href="../kunpeng1-R-instpkgs.html">4039</A></TD></TR>
<TR><TD COLSPAN="5" style="font-size: smaller;"><I>Click on any hostname to see more info about the system (e.g. compilers) &nbsp;&nbsp;&nbsp;&nbsp; (*) as reported by 'uname -p', except on Windows and Mac OS X</I></TD></TR>
</TABLE>
<BR>
<H2><SPAN class="kunpeng1">CHECK results for goSorensen on kunpeng1</SPAN></H2>
<BR>
<DIV class="motd">
<TABLE><TR><TD>
To the developers/maintainers of the goSorensen package:<BR>
- Please allow up to 24 hours (and sometimes 48 hours) for your latest push to git@git.bioconductor.org:packages/goSorensen.git to<BR>reflect on this report. See <A href="https://bioconductor.org/developers/how-to/troubleshoot-build-report/">How and When does the builder pull? When will my changes propagate?</A> for more information.<BR>
- Make sure to <A href="../Renviron.bioc">use the following settings</A> in order to reproduce any error or warning you see on this page.<BR>
</TD></TR></TABLE>
</DIV>
<P style="text-align: center;"><A href="raw-results/">raw results</A><P>
<TABLE class="gcard_list">
<TBODY class="gcard ok">
<TR class="header"><TD class="leftmost top_left_corner"></TD><TD>Package <B>831</B>/2164</TD><TD style="width: 75px;">Hostname</TD><TD style="width: 225px;">OS&nbsp;/&nbsp;Arch</TD><TD class="STAGE install">INSTALL</TD><TD class="STAGE buildsrc">BUILD</TD><TD class="STAGE checksrc selected">CHECK</TD><TD class="STAGE buildbin">BUILD BIN</TD><TD style="width: 12px;"></TD><TD class="rightmost top_right_corner"></TD></TR>
<TR class="selected_row"><TD ROWSPAN="2" class="leftmost bottom_left_corner"></TD><TD ROWSPAN="1" style="vertical-align: top;"><B><A href="./">goSorensen</A>&nbsp;1.1.0</B>&nbsp;&nbsp;<SPAN style="font-size: smaller; font-style: italic;">(<A href="/packages/3.17/goSorensen">landing page</A>)</SPAN><BR>Pablo Flores<BR><TABLE class="svn_info">
<TR><TD class="svn_info">Snapshot&nbsp;Date:&nbsp;<SPAN class="svn_info">2023-02-01&nbsp;03:13:00&nbsp;-0000&nbsp;(Wed,&nbsp;01&nbsp;Feb&nbsp;2023)</SPAN></TD></TR>
<TR><TD class="svn_info">git_url:&nbsp;<SPAN class="svn_info">https://git.bioconductor.org/packages/goSorensen</SPAN></TD></TR>
<TR><TD class="svn_info">git_branch:&nbsp;<SPAN class="svn_info">master</SPAN></TD></TR>
<TR><TD class="svn_info">git_last_commit:&nbsp;<SPAN class="svn_info">d6d3632</SPAN></TD></TR>
<TR><TD class="svn_info">git_last_commit_date:&nbsp;<SPAN class="svn_info">2022-11-01&nbsp;15:27:22&nbsp;-0000&nbsp;(Tue,&nbsp;01&nbsp;Nov&nbsp;2022)</SPAN></TD></TR>
</TABLE>
</TD><TD class="kunpeng1 selected"><B>kunpeng1</B></TD><TD class="kunpeng1"><SPAN style="font-size: smaller;">Linux&nbsp;(Ubuntu&nbsp;22.04.1&nbsp;LTS)&nbsp;/&nbsp;aarch64</SPAN></TD><TD class="status kunpeng1 install"><A href="./kunpeng1-install.html" onmouseover="add_class_mouseover(this);" onmouseout="remove_class_mouseover(this);"><SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></A></TD><TD class="status kunpeng1 buildsrc"><A href="./kunpeng1-buildsrc.html" onmouseover="add_class_mouseover(this);" onmouseout="remove_class_mouseover(this);"><SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></A></TD><TD class="status kunpeng1 checksrc selected"><A href="./kunpeng1-checksrc.html" onmouseover="add_class_mouseover(this);" onmouseout="remove_class_mouseover(this);"><SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></A></TD><TD class="status kunpeng1"></TD><TD class="status kunpeng1"></TD><TD ROWSPAN="2" class="rightmost bottom_right_corner"></TD></TR>
<TR class="footer"><TD COLSPAN="8"></TD></TR>
</TBODY>
</TABLE>
<HR>
<H3>Summary</H3>
<DIV class="kunpeng1 hscrollable">
<TABLE>
<TR><TD><B>Package</B>: goSorensen</TD></TR>
<TR><TD><B>Version</B>: 1.1.0</TD></TR>
<TR><TD><B>Command</B>: /home/biocbuild/bbs-3.17-bioc/R/bin/R CMD check --install=check:goSorensen.install-out.txt --library=/home/biocbuild/bbs-3.17-bioc/R/library --timings goSorensen_1.1.0.tar.gz</TD></TR>
<TR><TD><B>StartedAt</B>: 2023-02-02 08:52:39 -0000 (Thu, 02 Feb 2023)</TD></TR>
<TR><TD><B>EndedAt</B>: 2023-02-02 09:14:34 -0000 (Thu, 02 Feb 2023)</TD></TR>
<TR><TD><B>EllapsedTime</B>: 1314.5 seconds</TD></TR>
<TR><TD><B>RetCode</B>: 0</TD></TR>
<TR><TD><B>Status</B>: <SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></TD></TR>
<TR><TD><B>CheckDir</B>: goSorensen.Rcheck</TD></TR>
<TR><TD><B>Warnings</B>: 0</TD></TR>
</TABLE>
</DIV>
<HR>
<H3>Command output</H3>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">
##############################################################################
##############################################################################
###
### Running command:
###
###   /home/biocbuild/bbs-3.17-bioc/R/bin/R CMD check --install=check:goSorensen.install-out.txt --library=/home/biocbuild/bbs-3.17-bioc/R/library --timings goSorensen_1.1.0.tar.gz
###
##############################################################################
##############################################################################


* using log directory ‘/home/biocbuild/bbs-3.17-bioc/meat/goSorensen.Rcheck’
* using R Under development (unstable) (2023-01-14 r83615)
* using platform: aarch64-unknown-linux-gnu (64-bit)
* R was compiled by
    gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0
    GNU Fortran (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0
* running under: Ubuntu 22.04.1 LTS
* using session charset: UTF-8
* checking for file ‘goSorensen/DESCRIPTION’ ... OK
* checking extension type ... Package
* this is package ‘goSorensen’ version ‘1.1.0’
* package encoding: UTF-8
* checking package namespace information ... OK
* checking package dependencies ... OK
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking for sufficient/correct file permissions ... OK
* checking whether package ‘goSorensen’ can be installed ... OK
* checking installed package size ... OK
* checking package directory ... OK
* checking ‘build’ directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies ... OK
* checking whether the package can be unloaded cleanly ... OK
* checking whether the namespace can be loaded with stated dependencies ... OK
* checking whether the namespace can be unloaded cleanly ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd metadata ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking contents of ‘data’ directory ... OK
* checking data for non-ASCII characters ... OK
* checking data for ASCII and uncompressed saves ... OK
* checking files in ‘vignettes’ ... OK
* checking examples ... OK
Examples with CPU (user + system) or elapsed time &gt; 5s
                   user system elapsed
buildEnrichTable 24.519  1.343  27.066
* checking for unstated dependencies in ‘tests’ ... OK
* checking tests ...
  Running ‘test_gosorensen_funcs.R’
  Running ‘test_nonsense_genes.R’
 OK
* checking for unstated dependencies in vignettes ... OK
* checking package vignettes in ‘inst/doc’ ... OK
* checking running R code from vignettes ...
  ‘goSorensen_Introduction.Rmd’ using ‘UTF-8’... OK
 NONE
* checking re-building of vignette outputs ... OK
* checking PDF version of manual ... OK
* DONE

Status: OK

</PRE>
</DIV><HR>
<H3>Installation output</H3>
<P><SPAN class="filename">goSorensen.Rcheck/00install.out</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">
##############################################################################
##############################################################################
###
### Running command:
###
###   /home/biocbuild/bbs-3.17-bioc/R/bin/R CMD INSTALL goSorensen
###
##############################################################################
##############################################################################


* installing to library ‘/home/biocbuild/bbs-3.17-bioc/R/library’
* installing *source* package ‘goSorensen’ ...
** using staged installation
** R
** data
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (goSorensen)
</PRE>
</DIV><HR>
<H3>Tests output</H3>
<P><SPAN class="filename">goSorensen.Rcheck/tests/test_gosorensen_funcs.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R Under development (unstable) (2023-01-14 r83615) -- &quot;Unsuffered Consequences&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; library(goSorensen)



Attaching package: &#x27;goSorensen&#x27;

The following object is masked from &#x27;package:utils&#x27;:

    upgrade

&gt; 
&gt; # A contingency table of GO terms mutual enrichment
&gt; # between gene lists &quot;atlas&quot; and &quot;sanger&quot;:
&gt; data(tab_atlas.sanger_BP3)
&gt; tab_atlas.sanger_BP3
                 Enriched in sanger
Enriched in atlas TRUE FALSE
            TRUE    56    30
            FALSE    1   471
&gt; ?tab_atlas.sanger_BP3
tab_atlas.sanger_BP3        package:goSorensen         R Documentation

_C_r_o_s_s-_t_a_b_u_l_a_t_i_o_n _o_f _e_n_r_i_c_h_e_d _G_O _i_t_e_m_s _a_t _l_e_v_e_l _3 _o_f _o_n_t_o_l_o_g_y _B_P _i_n _t_w_o
_g_e_n_e _l_i_s_t_s

_D_e_s_c_r_i_p_t_i_o_n:

     From the &quot;Cancer gene list&quot; of Bushman Lab, a collection of gene
     lists related with cancer, for gene lists &quot;Atlas&quot; and &quot;Sanger&quot;,
     this dataset is the cross-tabulation of all GO items of ontology
     BP at level 3 which are: Enriched in both lists, enriched in
     sanger but not in atlas, non-enriched in sanger but enriched in
     atlas and non-enriched in both lists. Take it just as an
     illustrative example, non up-to-date for changes in the gene lists
     or changes in the GO.

_U_s_a_g_e:

     data(tab_atlas.sanger_BP3)
     
_F_o_r_m_a_t:

     An object of class &quot;table&quot; representing a 2x2 contingency table.

_S_o_u_r_c_e:

     &lt;http://www.bushmanlab.org/links/genelists&gt;


&gt; class(tab_atlas.sanger_BP3)
[1] &quot;table&quot;
&gt; 
&gt; # Sorensen-Dice dissimilarity on this contingency table:
&gt; ?dSorensen
dSorensen              package:goSorensen              R Documentation

_C_o_m_p_u_t_a_t_i_o_n _o_f _t_h_e _S_o_r_e_n_s_e_n-_D_i_c_e _d_i_s_s_i_m_i_l_a_r_i_t_y

_D_e_s_c_r_i_p_t_i_o_n:

     Computation of the Sorensen-Dice dissimilarity

_U_s_a_g_e:

     dSorensen(x, ...)
     
     ## S3 method for class &#x27;table&#x27;
     dSorensen(x, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;matrix&#x27;
     dSorensen(x, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;numeric&#x27;
     dSorensen(x, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;character&#x27;
     dSorensen(x, y, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;list&#x27;
     dSorensen(x, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;tableList&#x27;
     dSorensen(x, check.table = TRUE, ...)
     
_A_r_g_u_m_e_n_t_s:

       x: either an object of class &quot;table&quot;, &quot;matrix&quot; or &quot;numeric&quot;
          representing a 2x2 contingency table, or a &quot;character&quot; vector
          (a set of gene identifiers) or &quot;list&quot; or &quot;tableList&quot; object.
          See the details section for more information.

     ...: extra parameters for function &#x27;buildEnrichTable&#x27;.

check.table: Boolean. If TRUE (default), argument &#x27;x&#x27; is checked to
          adequately represent a 2x2 contingency table, by means of
          function &#x27;nice2x2Table&#x27;.

       y: an object of class &quot;character&quot; representing a vector of valid
          gene identifiers.

_D_e_t_a_i_l_s:

     Given a 2x2 arrangement of frequencies (either implemented as a
     &quot;table&quot;, a &quot;matrix&quot; or a &quot;numeric&quot; object):

       n11   n01 
       n10  n00, 
      
     this function computes the Sorensen-Dice dissimilarity

                    {n_10 + n_01}/{2 n_11 + n_10 + n_01}.               
     
     The subindex &#x27;11&#x27; corresponds to those GO items enriched in both
     lists, &#x27;01&#x27; to items enriched in the second list but not in the
     first one, &#x27;10&#x27; to items enriched in the first list but not
     enriched in the second one and &#x27;00&#x27; corresponds to those GO items
     non enriched in both gene lists, i.e., to the double negatives, a
     value which is ignored in the computations.

     In the &quot;numeric&quot; interface, if &#x27;length(x) &gt;= 3&#x27;, the values are
     interpreted as

     (n_11, n_01, n_10, n_00), always in this order and discarding
     extra values if necessary. The result is correct, regardless the
     frequencies being absolute or relative.

     If &#x27;x&#x27; is an object of class &quot;character&quot;, then &#x27;x&#x27; (and &#x27;y&#x27;) must
     represent two &quot;character&quot; vectors of valid gene identifiers. Then
     the dissimilarity between lists &#x27;x&#x27; and &#x27;y&#x27; is computed, after
     internally summarizing them as a 2x2 contingency table of joint
     enrichment. This last operation is performed by function
     &#x27;buildEnrichTable&#x27; and &quot;valid gene identifiers&quot; stands for the
     coherency of these gene identifiers with the arguments
     &#x27;geneUniverse&#x27; and &#x27;orgPackg&#x27; of &#x27;buildEnrichTable&#x27;, passed by the
     ellipsis argument &#x27;...&#x27; in &#x27;dSorensen&#x27;.

     If &#x27;x&#x27; is an object of class &quot;list&quot;, the argument must be a list
     of &quot;character&quot; vectors, each one representing a gene list
     (character identifiers). Then, all pairwise dissimilarities
     between these gene lists are computed.

     If &#x27;x&#x27; is an object of class &quot;tableList&quot;, the Sorensen-Dice
     dissimilarity is computed over each one of these tables. Given k
     gene lists (i.e. &quot;character&quot; vectors of gene identifiers) l1, l2,
     ..., lk, an object of class &quot;tableList&quot; (typically constructed by
     a call to function &#x27;buildEnrichTable&#x27;) is a list of lists of
     contingency tables t(i,j) generated from each pair of gene lists i
     and j, with the following structure:

     $l2

     $l2$l1$t(2,1)

     $l3

     $l3$l1$t(3,1), $l3$l2$t(3,2)

     ...

     $lk

     $lk$l1$t(k,1), $lk$l2$t(k,2), ..., $lk$l(k-1)t(k,k-1)

_V_a_l_u_e:

     In the &quot;table&quot;, &quot;matrix&quot;, &quot;numeric&quot; and &quot;character&quot; interfaces,
     the value of the Sorensen-Dice dissimilarity. In the &quot;list&quot; and
     &quot;tableList&quot; interfaces, the symmetric matrix of all pairwise
     Sorensen-Dice dissimilarities.

_M_e_t_h_o_d_s (_b_y _c_l_a_s_s):

        • &#x27;table&#x27;: S3 method for class &quot;table&quot;

        • &#x27;matrix&#x27;: S3 method for class &quot;matrix&quot;

        • &#x27;numeric&#x27;: S3 method for class &quot;numeric&quot;

        • &#x27;character&#x27;: S3 method for class &quot;character&quot;

        • &#x27;list&#x27;: S3 method for class &quot;list&quot;

        • &#x27;tableList&#x27;: S3 method for class &quot;tableList&quot;

_S_e_e _A_l_s_o:

     &#x27;buildEnrichTable&#x27; for constructing contingency tables of mutual
     enrichment, &#x27;nice2x2Table&#x27; for checking contingency tables
     validity, &#x27;seSorensen&#x27; for computing the standard error of the
     dissimilarity, &#x27;duppSorensen&#x27; for the upper limit of a one-sided
     confidence interval of the dissimilarity, &#x27;equivTestSorensen&#x27; for
     an equivalence test.

_E_x_a_m_p_l_e_s:

     # Gene lists &#x27;atlas&#x27; and &#x27;sanger&#x27; in &#x27;allOncoGeneLists&#x27; dataset. Table of joint enrichment
     # of GO items in ontology BP at level 3.
     data(tab_atlas.sanger_BP3)
     tab_atlas.sanger_BP3
     ?tab_atlas.sanger_BP3
     dSorensen(tab_atlas.sanger_BP3)
     
     # Table represented as a vector:
     conti4 &lt;- c(56, 1, 30, 471)
     dSorensen(conti4)
     # or as a plain matrix:
     dSorensen(matrix(conti4, nrow = 2))
     
     # This function is also appropriate for proportions:
     dSorensen(conti4 / sum(conti4))
     
     conti3 &lt;- c(56, 1, 30)
     dSorensen(conti3)
     
     # Sorensen-Dice dissimilarity from scratch, directly from two gene lists:
     # (These examples may be considerably time consuming due to many enrichment
     # tests to build the contingency tables of mutual enrichment)
     # data(pbtGeneLists)
     # ?pbtGeneLists
     # data(humanEntrezIDs)
     # (Time consuming, building the table requires many enrichment tests:)
     # dSorensen(pbtGeneLists[[2]], pbtGeneLists[[4]],
     #           onto = &quot;CC&quot;, GOLevel = 3,
     #           geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
     # Essentially, the above code makes the same as:
     # tab.IRITD3vsKT1 &lt;- buildEnrichTable(pbtGeneLists[[2]], pbtGeneLists[[4]],
     #                                     onto = &quot;CC&quot;, GOLevel = 3,
     #                                     geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
     # dSorensen(tab.IRITD3vsKT1)
     # (Quite time consuming, all pairwise dissimilarities:)
     # dSorensen(pbtGeneLists,
     #           onto = &quot;CC&quot;, GOLevel = 3,
     #           geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
     

&gt; dSorensen(tab_atlas.sanger_BP3)
[1] 0.2167832
&gt; 
&gt; # Standard error of this Sorensen-Dice dissimilarity estimate:
&gt; ?seSorensen
seSorensen             package:goSorensen              R Documentation

_S_t_a_n_d_a_r_d _e_r_r_o_r _o_f _t_h_e _s_a_m_p_l_e _S_o_r_e_n_s_e_n-_D_i_c_e _d_i_s_s_i_m_i_l_a_r_i_t_y, _a_s_y_m_p_t_o_t_i_c
_a_p_p_r_o_a_c_h

_D_e_s_c_r_i_p_t_i_o_n:

     Standard error of the sample Sorensen-Dice dissimilarity,
     asymptotic approach

_U_s_a_g_e:

     seSorensen(x, ...)
     
     ## S3 method for class &#x27;table&#x27;
     seSorensen(x, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;matrix&#x27;
     seSorensen(x, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;numeric&#x27;
     seSorensen(x, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;character&#x27;
     seSorensen(x, y, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;list&#x27;
     seSorensen(x, check.table = TRUE, ...)
     
     ## S3 method for class &#x27;tableList&#x27;
     seSorensen(x, check.table = TRUE, ...)
     
_A_r_g_u_m_e_n_t_s:

       x: either an object of class &quot;table&quot;, &quot;matrix&quot; or &quot;numeric&quot;
          representing a 2x2 contingency table, or a &quot;character&quot; (a set
          of gene identifiers) or &quot;list&quot; or &quot;tableList&quot; object. See the
          details section for more information.

     ...: extra parameters for function &#x27;buildEnrichTable&#x27;.

check.table: Boolean. If TRUE (default), argument &#x27;x&#x27; is checked to
          adequately represent a 2x2 contingency table. This checking
          is performed by means of function &#x27;nice2x2Table&#x27;.

       y: an object of class &quot;character&quot; representing a vector of gene
          identifiers.

_D_e_t_a_i_l_s:

     This function computes the standard error estimate of the sample
     Sorensen-Dice dissimilarity, given a 2x2 arrangement of
     frequencies (either implemented as a &quot;table&quot;, a &quot;matrix&quot; or a
     &quot;numeric&quot; object):

       n11   n10 
       n01  n00, 
      
     The subindex &#x27;11&#x27; corresponds to those GO items enriched in both
     lists, &#x27;01&#x27; to items enriched in the second list but not in the
     first one, &#x27;10&#x27; to items enriched in the first list but not
     enriched in the second one and &#x27;00&#x27; corresponds to those GO items
     non enriched in both gene lists, i.e., to the double negatives, a
     value which is ignored in the computations.

     In the &quot;numeric&quot; interface, if &#x27;length(x) &gt;= 3&#x27;, the values are
     interpreted as

     (n_11, n_01, n_10), always in this order.

     If &#x27;x&#x27; is an object of class &quot;character&quot;, then &#x27;x&#x27; (and &#x27;y&#x27;) must
     represent two &quot;character&quot; vectors of valid gene identifiers. Then
     the standard error for the dissimilarity between lists &#x27;x&#x27; and &#x27;y&#x27;
     is computed, after internally summarizing them as a 2x2
     contingency table of joint enrichment. This last operation is
     performed by function &#x27;buildEnrichTable&#x27; and &quot;valid gene
     identifiers&quot; stands for the coherency of these gene identifiers
     with the arguments &#x27;geneUniverse&#x27; and &#x27;orgPackg&#x27; of
     &#x27;buildEnrichTable&#x27;, passed by the ellipsis argument &#x27;...&#x27; in
     &#x27;seSorensen&#x27;.

     In the &quot;list&quot; interface, the argument must be a list of
     &quot;character&quot; vectors, each one representing a gene list (character
     identifiers). Then, all pairwise standard errors of the
     dissimilarity between these gene lists are computed.

     If &#x27;x&#x27; is an object of class &quot;tableList&quot;, the standard error of
     the Sorensen-Dice dissimilarity estimate is computed over each one
     of these tables. Given k gene lists (i.e. &quot;character&quot; vectors of
     gene identifiers) l1, l2, ..., lk, an object of class &quot;tableList&quot;
     (typically constructed by a call to function &#x27;buildEnrichTable&#x27;)
     is a list of lists of contingency tables t(i,j) generated from
     each pair of gene lists i and j, with the following structure:

     $l2

     $l2$l1$t(2,1)

     $l3

     $l3$l1$t(3,1), $l3$l2$t(3,2)

     ...

     $lk

     $lk$l1$t(k,1), $lk$l2$t(k,2), ..., $lk$l(k-1)t(k,k-1)

_V_a_l_u_e:

     In the &quot;table&quot;, &quot;matrix&quot;, &quot;numeric&quot; and &quot;character&quot; interfaces,
     the value of the standard error of the Sorensen-Dice dissimilarity
     estimate. In the &quot;list&quot; and &quot;tableList&quot; interfaces, the symmetric
     matrix of all standard error dissimilarity estimates.

_M_e_t_h_o_d_s (_b_y _c_l_a_s_s):

        • &#x27;table&#x27;: S3 method for class &quot;table&quot;

        • &#x27;matrix&#x27;: S3 method for class &quot;matrix&quot;

        • &#x27;numeric&#x27;: S3 method for class &quot;numeric&quot;

        • &#x27;character&#x27;: S3 method for class &quot;character&quot;

        • &#x27;list&#x27;: S3 method for class &quot;list&quot;

        • &#x27;tableList&#x27;: S3 method for class &quot;tableList&quot;

_S_e_e _A_l_s_o:

     &#x27;buildEnrichTable&#x27; for constructing contingency tables of mutual
     enrichment, &#x27;nice2x2Table&#x27; for checking the validity of enrichment
     contingency tables, &#x27;dSorensen&#x27; for computing the Sorensen-Dice
     dissimilarity, &#x27;duppSorensen&#x27; for the upper limit of a one-sided
     confidence interval of the dissimilarity, &#x27;equivTestSorensen&#x27; for
     an equivalence test.

_E_x_a_m_p_l_e_s:

     # Gene lists &#x27;atlas&#x27; and &#x27;sanger&#x27; in &#x27;Cangenes&#x27; dataset. Table of joint enrichment
     # of GO items in ontology BP at level 3.
     data(tab_atlas.sanger_BP3)
     tab_atlas.sanger_BP3
     dSorensen(tab_atlas.sanger_BP3)
     seSorensen(tab_atlas.sanger_BP3)
     
     # Contingency table as a numeric vector:
     seSorensen(c(56, 1, 30, 47))
     seSorensen(c(56, 1, 30))
     
     # (These examples may be considerably time consuming due to many enrichment
     # tests to build the contingency tables of mutual enrichment)
     # ?pbtGeneLists
     # Standard error of the sample Sorensen-Dice dissimilarity, directly from
     # two gene lists, from scratch:
     # seSorensen(pbtGeneLists[[2]], pbtGeneLists[[4]],
     #            onto = &quot;CC&quot;, GOLevel = 5,
     #            geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
     # Essentially, the above code makes the same as:
     # tab.IRITD3vsKT1 &lt;- buildEnrichTable(pbtGeneLists[[2]], pbtGeneLists[[4]],
     #                                     onto = &quot;CC&quot;, GOLevel = 5,
     #                                     geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
     # tab.IRITD3vsKT1
     # seSorensen(tab.IRITD3vsKT1)
     
     # All pairwise standard errors (quite time consuming):
     # seSorensen(pbtGeneLists,
     #            onto = &quot;CC&quot;, GOLevel = 5,
     #            geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
     

&gt; seSorensen(tab_atlas.sanger_BP3)
[1] 0.03822987
&gt; 
&gt; # Upper 95% confidence limit for the Sorensen-Dice dissimilarity:
&gt; ?duppSorensen
duppSorensen            package:goSorensen             R Documentation

_U_p_p_e_r _l_i_m_i_t _o_f _a _o_n_e-_s_i_d_e_d _c_o_n_f_i_d_e_n_c_e _i_n_t_e_r_v_a_l (_0, _d_U_p_p] _f_o_r _t_h_e
_S_o_r_e_n_s_e_n-_D_i_c_e _d_i_s_s_i_m_i_l_a_r_i_t_y

_D_e_s_c_r_i_p_t_i_o_n:

     Upper limit of a one-sided confidence interval (0, dUpp] for the
     Sorensen-Dice dissimilarity

_U_s_a_g_e:

     duppSorensen(x, ...)
     
     ## S3 method for class &#x27;table&#x27;
     duppSorensen(
       x,
       dis = dSorensen.table(x, check.table = FALSE),
       se = seSorensen.table(x, check.table = FALSE),
       conf.level = 0.95,
       z.conf.level = qnorm(1 - conf.level),
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;matrix&#x27;
     duppSorensen(
       x,
       dis = dSorensen.matrix(x, check.table = FALSE),
       se = seSorensen.matrix(x, check.table = FALSE),
       conf.level = 0.95,
       z.conf.level = qnorm(1 - conf.level),
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;numeric&#x27;
     duppSorensen(
       x,
       dis = dSorensen.numeric(x, check.table = FALSE),
       se = seSorensen.numeric(x, check.table = FALSE),
       conf.level = 0.95,
       z.conf.level = qnorm(1 - conf.level),
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;character&#x27;
     duppSorensen(
       x,
       y,
       conf.level = 0.95,
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;list&#x27;
     duppSorensen(
       x,
       conf.level = 0.95,
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;tableList&#x27;
     duppSorensen(
       x,
       conf.level = 0.95,
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
_A_r_g_u_m_e_n_t_s:

       x: either an object of class &quot;table&quot;, &quot;matrix&quot; or &quot;numeric&quot;
          representing a 2x2 contingency table, or a &quot;character&quot; (a set
          of gene identifiers) or &quot;list&quot; or &quot;tableList&quot; object. See the
          details section for more information.

     ...: additional arguments for function &#x27;buildEnrichTable&#x27;.

     dis: Sorensen-Dice dissimilarity value. Only required to speed
          computations if this value is known in advance.

      se: standard error estimate of the sample dissimilarity. Only
          required to speed computations if this value is known in
          advance.

conf.level: confidence level of the one-sided confidence interval, a
          numeric value between 0 and 1.

z.conf.level: standard normal (or bootstrap, see arguments below)
          distribution quantile at the &#x27;1 - conf.level&#x27; value. Only
          required to speed computations if this value is known in
          advance. Then, the argument &#x27;conf.level&#x27; is ignored.

    boot: boolean. If TRUE, &#x27;z.conf.level&#x27; is computed by means of a
          bootstrap approach instead of the asymptotic normal approach.
          Defaults to FALSE.

   nboot: numeric, number of initially planned bootstrap replicates.
          Ignored if &#x27;boot == FALSE&#x27;. Defaults to 10000.

check.table: Boolean. If TRUE (default), argument &#x27;x&#x27; is checked to
          adequately represent a 2x2 contingency table. This checking
          is performed by means of function &#x27;nice2x2Table&#x27;.

       y: an object of class &quot;character&quot; representing a vector of gene
          identifiers.

_D_e_t_a_i_l_s:

     This function computes the upper limit of a one-sided confidence
     interval for the Sorensen-Dice dissimilarity, given a 2x2
     arrangement of frequencies (either implemented as a &quot;table&quot;, a
     &quot;matrix&quot; or a &quot;numeric&quot; object):

       n11   n01 
       n10  n00, 
      
     The subindex &#x27;11&#x27; corresponds to those GO items enriched in both
     lists, &#x27;01&#x27; to items enriched in the second list but not in the
     first one, &#x27;10&#x27; to items enriched in the first list but not
     enriched in the second one and &#x27;00&#x27; corresponds to those GO items
     non enriched in both gene lists, i.e., to the double negatives, a
     value which is ignored in the computations, except if &#x27;boot ==
     TRUE&#x27;.

     In the &quot;numeric&quot; interface, if &#x27;length(x) &gt;= 4&#x27;, the values are
     interpreted as

     (n_11, n_01, n_10, n_00), always in this order and discarding
     extra values if necessary.

     Arguments &#x27;dis&#x27;, &#x27;se&#x27; and &#x27;z.conf.level&#x27; are not required. If
     known in advance (e.g., as a consequence of previous computations
     with the same data), providing its value may speed the
     computations.

     By default, &#x27;z.conf.level&#x27; corresponds to the 1 - conf.level
     quantile of a standard normal N(0,1) distribution, as the
     studentized statistic (^d - d) / ^se) is asymptotically N(0,1). In
     the studentized statistic, d stands for the &quot;true&quot; Sorensen-Dice
     dissimilarity, ^d to its sample estimate and ^se for the estimate
     of its standard error. In fact, the normal is its limiting
     distribution but, for finite samples, the true sampling
     distribution may present departures from normality (mainly with
     some inflation in the left tail). The bootstrap method provides a
     better approximation to the true sampling distribution. In the
     bootstrap approach, &#x27;nboot&#x27; new bootstrap contingency tables are
     generated from a multinomial distribution with parameters &#x27;size =&#x27;
     n11 + n01 + n10 + n00 and probabilities %. Sometimes, some of
     these generated tables may present so low frequencies of
     enrichment that make them unable for Sorensen-Dice computations.
     As a consequence, the number of effective bootstrap samples may be
     lower than the number of initially planned bootstrap samples
     &#x27;nboot&#x27;. Computing in advance the value of argument &#x27;z.conf.level&#x27;
     may be a way to cope with these departures from normality, by
     means of a more adequate quantile function. Alternatively, if
     &#x27;boot == TRUE&#x27;, a bootstrap quantile is internally computed.

     If &#x27;x&#x27; is an object of class &quot;character&quot;, then &#x27;x&#x27; (and &#x27;y&#x27;) must
     represent two &quot;character&quot; vectors of valid gene identifiers. Then
     the confidence interval for the dissimilarity between lists &#x27;x&#x27;
     and &#x27;y&#x27; is computed, after internally summarizing them as a 2x2
     contingency table of joint enrichment. This last operation is
     performed by function &#x27;buildEnrichTable&#x27; and &quot;valid gene
     identifiers&quot; stands for the coherency of these gene identifiers
     with the arguments &#x27;geneUniverse&#x27; and &#x27;orgPackg&#x27; of
     &#x27;buildEnrichTable&#x27;, passed by the ellipsis argument &#x27;...&#x27; in
     &#x27;dUppSorensen&#x27;.

     In the &quot;list&quot; interface, the argument must be a list of
     &quot;character&quot; vectors, each one representing a gene list (character
     identifiers). Then, all pairwise upper limits of the dissimilarity
     between these gene lists are computed.

     In the &quot;tableList&quot; interface, the upper limits are computed over
     each one of these tables. Given gene lists (i.e. &quot;character&quot;
     vectors of gene identifiers) l1, l2, ..., lk, an object of class
     &quot;tableList&quot; (typically constructed by a call to function
     &#x27;buildEnrichTable&#x27;) is a list of lists of contingency tables
     t(i,j) generated from each pair of gene lists i and j, with the
     following structure:

     $l2

     $l2$l1$t(2,1)

     $l3

     $l3$l1$t(3,1), $l3$l2$t(3,2)

     ...

     $lk

     $lk$l1$t(k,1), $lk$l2$t(k,2), ..., $lk$l(k-1)t(k,k-1)

_V_a_l_u_e:

     In the &quot;table&quot;, &quot;matrix&quot;, &quot;numeric&quot; and &quot;character&quot; interfaces,
     the value of the Upper limit of the confidence interval for the
     Sorensen-Dice dissimilarity. When &#x27;boot == TRUE&#x27;, this result also
     haves a an extra attribute: &quot;eff.nboot&quot; which corresponds to the
     number of effective bootstrap replicats, see the details section.
     In the &quot;list&quot; and &quot;tableList&quot; interfaces, the result is the
     symmetric matrix of all pairwise upper limits.

_M_e_t_h_o_d_s (_b_y _c_l_a_s_s):

        • &#x27;table&#x27;: S3 method for class &quot;table&quot;

        • &#x27;matrix&#x27;: S3 method for class &quot;matrix&quot;

        • &#x27;numeric&#x27;: S3 method for class &quot;numeric&quot;

        • &#x27;character&#x27;: S3 method for class &quot;character&quot;

        • &#x27;list&#x27;: S3 method for class &quot;list&quot;

        • &#x27;tableList&#x27;: S3 method for class &quot;tableList&quot;

_S_e_e _A_l_s_o:

     &#x27;buildEnrichTable&#x27; for constructing contingency tables of mutual
     enrichment, &#x27;nice2x2Table&#x27; for checking contingency tables
     validity, &#x27;dSorensen&#x27; for computing the Sorensen-Dice
     dissimilarity, &#x27;seSorensen&#x27; for computing the standard error of
     the dissimilarity, &#x27;equivTestSorensen&#x27; for an equivalence test.

_E_x_a_m_p_l_e_s:

     # Gene lists &#x27;atlas&#x27; and &#x27;sanger&#x27; in &#x27;Cangenes&#x27; dataset. Table of joint enrichment
     # of GO items in ontology BP at level 3.
     data(tab_atlas.sanger_BP3)
     ?tab_atlas.sanger_BP3
     duppSorensen(tab_atlas.sanger_BP3)
     dSorensen(tab_atlas.sanger_BP3) + qnorm(0.95) * seSorensen(tab_atlas.sanger_BP3)
     # Using the bootstrap approximation instead of the normal approximation to
     # the sampling distribution of (^d - d) / se(^d):
     duppSorensen(tab_atlas.sanger_BP3, boot = TRUE)
     
     # Contingency table as a numeric vector:
     duppSorensen(c(56, 1, 30, 47))
     duppSorensen(c(56, 1, 30))
     
     # Upper confidence limit for the Sorensen-Dice dissimilarity, from scratch,
     # directly from two gene lists:
     # (These examples may be considerably time consuming due to many enrichment
     # tests to build the contingency tables of mutual enrichment)
     # data(pbtGeneLists)
     # ?pbtGeneLists
     # data(humanEntrezIDs)
     # duppSorensen(pbtGeneLists[[2]], pbtGeneLists[[4]],
     #              onto = &quot;CC&quot;, GOLevel = 5,
     #              geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
     # Even more time consuming (all pairwise values):
     # duppSorensen(pbtGeneLists,
     #              onto = &quot;CC&quot;, GOLevel = 5,
     #              geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
     

&gt; duppSorensen(tab_atlas.sanger_BP3)
[1] 0.2796658
&gt; # This confidence limit is based on an assimptotic normal N(0,1)
&gt; # approximation to the distribution of (dSampl - d) / se, where
&gt; # dSampl stands for the sample dissimilarity, d for the true dissimilarity
&gt; # and se for the sample dissimilarity standard error estimate.
&gt; 
&gt; # Upper confidence limit but using a Student&#x27;s t instead of a N(0,1)
&gt; # (just as an example, not recommended -no theoretical justification)
&gt; df &lt;- sum(tab_atlas.sanger_BP3[1:3]) - 2
&gt; duppSorensen(tab_atlas.sanger_BP3, z.conf.level = qt(1 - 0.95, df))
[1] 0.2803587
&gt; 
&gt; # Upper confidence limit but using a bootstrap approximation
&gt; # to the sampling distribution, instead of a N(0,1)
&gt; set.seed(123)
&gt; duppSorensen(tab_atlas.sanger_BP3, boot = TRUE)
[1] 0.2871182
attr(,&quot;eff.nboot&quot;)
[1] 10000
&gt; 
&gt; # Some computations on diverse data structures:
&gt; badConti &lt;- as.table(matrix(c(501, 27, 36, 12, 43, 15, 0, 0, 0),
+                             nrow = 3, ncol = 3,
+                             dimnames = list(c(&quot;a1&quot;,&quot;a2&quot;,&quot;a3&quot;),
+                                             c(&quot;b1&quot;, &quot;b2&quot;,&quot;b3&quot;))))
&gt; tryCatch(nice2x2Table(badConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(badConti): Not a 2x2 table&gt;
&gt; 
&gt; incompleteConti &lt;- badConti[1,1:min(2,ncol(badConti)), drop = FALSE]
&gt; incompleteConti
    b1  b2
a1 501  12
&gt; tryCatch(nice2x2Table(incompleteConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(incompleteConti): Not a 2x2 table&gt;
&gt; 
&gt; contiAsVector &lt;- c(32, 21, 81, 1439)
&gt; nice2x2Table(contiAsVector)
[1] TRUE
&gt; contiAsVector.mat &lt;- matrix(contiAsVector, nrow = 2)
&gt; contiAsVector.mat
     [,1] [,2]
[1,]   32   81
[2,]   21 1439
&gt; contiAsVectorLen3 &lt;- c(32, 21, 81)
&gt; nice2x2Table(contiAsVectorLen3)
[1] TRUE
&gt; 
&gt; tryCatch(dSorensen(badConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(x): Not a 2x2 table&gt;
&gt; 
&gt; # Apparently, the next order works fine, but returns a wrong value!
&gt; dSorensen(badConti, check.table = FALSE)
[1] 0.05915493
&gt; 
&gt; tryCatch(dSorensen(incompleteConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(x): Not a 2x2 table&gt;
&gt; dSorensen(contiAsVector)
[1] 0.6144578
&gt; dSorensen(contiAsVector.mat)
[1] 0.6144578
&gt; dSorensen(contiAsVectorLen3)
[1] 0.6144578
&gt; dSorensen(contiAsVectorLen3, check.table = FALSE)
[1] 0.6144578
&gt; dSorensen(c(0,0,0,45))
[1] NaN
&gt; 
&gt; tryCatch(seSorensen(badConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(x): Not a 2x2 table&gt;
&gt; tryCatch(seSorensen(incompleteConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(x): Not a 2x2 table&gt;
&gt; seSorensen(contiAsVector)
[1] 0.04818012
&gt; seSorensen(contiAsVector.mat)
[1] 0.04818012
&gt; seSorensen(contiAsVectorLen3)
[1] 0.04818012
&gt; seSorensen(contiAsVectorLen3, check.table = FALSE)
[1] 0.04818012
&gt; tryCatch(seSorensen(contiAsVectorLen3, check.table = &quot;not&quot;), error = function(e) {return(e)})
&lt;simpleError in seSorensen.numeric(contiAsVectorLen3, check.table = &quot;not&quot;): Argument &#x27;check.table&#x27; must be logical&gt;
&gt; seSorensen(c(0,0,0,45))
[1] NaN
&gt; 
&gt; tryCatch(duppSorensen(badConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(x): Not a 2x2 table&gt;
&gt; tryCatch(duppSorensen(incompleteConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(x): Not a 2x2 table&gt;
&gt; duppSorensen(contiAsVector)
[1] 0.6937071
&gt; duppSorensen(contiAsVector.mat)
[1] 0.6937071
&gt; set.seed(123)
&gt; duppSorensen(contiAsVector, boot = TRUE)
[1] 0.6922658
attr(,&quot;eff.nboot&quot;)
[1] 10000
&gt; set.seed(123)
&gt; duppSorensen(contiAsVector.mat, boot = TRUE)
[1] 0.6922658
attr(,&quot;eff.nboot&quot;)
[1] 10000
&gt; duppSorensen(contiAsVectorLen3)
[1] 0.6937071
&gt; # Bootstrapping requires full contingency tables (4 values)
&gt; set.seed(123)
&gt; tryCatch(duppSorensen(contiAsVectorLen3, boot = TRUE), error = function(e) {return(e)})
&lt;simpleError in duppSorensen.numeric(contiAsVectorLen3, boot = TRUE): Bootstraping requires a numeric vector of 4 frequencies&gt;
&gt; duppSorensen(c(0,0,0,45))
[1] NaN
&gt; 
&gt; # Equivalence test, H0: d &gt;= d0 vs  H1: d &lt; d0 (d0 = 0.4444)
&gt; ?equivTestSorensen
equivTestSorensen          package:goSorensen          R Documentation

_E_q_u_i_v_a_l_e_n_c_e _t_e_s_t _b_a_s_e_d _o_n _t_h_e _S_o_r_e_n_s_e_n-_D_i_c_e _d_i_s_s_i_m_i_l_a_r_i_t_y

_D_e_s_c_r_i_p_t_i_o_n:

     Equivalence test based on the Sorensen-Dice dissimilarity,
     computed either by an asymptotic normal approach or by a bootstrap
     approach.

_U_s_a_g_e:

     equivTestSorensen(x, ...)
     
     ## S3 method for class &#x27;table&#x27;
     equivTestSorensen(
       x,
       d0 = 1/(1 + 1.25),
       conf.level = 0.95,
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;matrix&#x27;
     equivTestSorensen(
       x,
       d0 = 1/(1 + 1.25),
       conf.level = 0.95,
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;numeric&#x27;
     equivTestSorensen(
       x,
       d0 = 1/(1 + 1.25),
       conf.level = 0.95,
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;character&#x27;
     equivTestSorensen(
       x,
       y,
       d0 = 1/(1 + 1.25),
       conf.level = 0.95,
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;list&#x27;
     equivTestSorensen(
       x,
       d0 = 1/(1 + 1.25),
       conf.level = 0.95,
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
     ## S3 method for class &#x27;tableList&#x27;
     equivTestSorensen(
       x,
       d0 = 1/(1 + 1.25),
       conf.level = 0.95,
       boot = FALSE,
       nboot = 10000,
       check.table = TRUE,
       ...
     )
     
_A_r_g_u_m_e_n_t_s:

       x: either an object of class &quot;table&quot;, &quot;matrix&quot;, &quot;numeric&quot;,
          &quot;character&quot;, &quot;list&quot; or &quot;tableList&quot;. See the details section
          for more information.

     ...: extra parameters for function &#x27;buildEnrichTable&#x27;.

      d0: equivalence threshold for the Sorensen-Dice dissimilarity, d.
          The null hypothesis states that d &gt;= d0, i.e., inequivalence
          between the compared gene lists and the alternative that d &lt;
          d0, i.e., equivalence or dissimilarity irrelevance (up to a
          level d0).

conf.level: confidence level of the one-sided confidence interval, a
          value between 0 and 1.

    boot: boolean. If TRUE, the confidence interval and the test
          p-value are computed by means of a bootstrap approach instead
          of the asymptotic normal approach. Defaults to FALSE.

   nboot: numeric, number of initially planned bootstrap replicates.
          Ignored if &#x27;boot == FALSE&#x27;. Defaults to 10000.

check.table: Boolean. If TRUE (default), argument &#x27;x&#x27; is checked to
          adequately represent a 2x2 contingency table. This checking
          is performed by means of function &#x27;nice2x2Table&#x27;.

       y: an object of class &quot;character&quot; representing a list of gene
          identifiers.

_D_e_t_a_i_l_s:

     This function computes either the normal asymptotic or the
     bootstrap equivalence test based on the Sorensen-Dice
     dissimilarity, given a 2x2 arrangement of frequencies (either
     implemented as a &quot;table&quot;, a &quot;matrix&quot; or a &quot;numeric&quot; object):

       n11   n10 
       n01  n00, 
      
     The subindex &#x27;11&#x27; corresponds to those GO items enriched in both
     lists, &#x27;01&#x27; to items enriched in the second list but not in the
     first one, &#x27;10&#x27; to items enriched in the first list but not
     enriched in the second one and &#x27;00&#x27; corresponds to those GO items
     non enriched in both gene lists, i.e., to the double negatives, a
     value which is ignored in the computations.

     In the &quot;numeric&quot; interface, if &#x27;length(x) &gt;= 4&#x27;, the values are
     interpreted as

     (n_11, n_01, n_10, n_00), always in this order and discarding
     extra values if necessary.

     If &#x27;x&#x27; is an object of class &quot;character&quot;, then &#x27;x&#x27; (and &#x27;y&#x27;) must
     represent two &quot;character&quot; vectors of valid gene identifiers. Then
     the equivalence test is performed between &#x27;x&#x27; and &#x27;y&#x27;, after
     internally summarizing them as a 2x2 contingency table of joint
     enrichment. This last operation is performed by function
     &#x27;buildEnrichTable&#x27; and &quot;valid gene identifiers&quot; stands for the
     coherency of these gene identifiers with the arguments
     &#x27;geneUniverse&#x27; and &#x27;orgPackg&#x27; of &#x27;buildEnrichTable&#x27;, passed by the
     ellipsis argument &#x27;...&#x27; in &#x27;equivTestSorensen&#x27;.

     If &#x27;x&#x27; is an object of class &quot;list&quot;, each of its elements must be
     a &quot;character&quot; vector of gene identifiers. Then all pairwise
     equivalence tests are performed between these gene lists.

     Class &quot;tableList&quot; corresponds to objects representing all mutual
     enrichment contingency tables generated in a pairwise fashion:
     Given gene lists l1, l2, ..., lk, an object of class &quot;tableList&quot;
     (typically constructed by a call to function &#x27;buildEnrichTable&#x27;)
     is a list of lists of contingency tables tij generated from each
     pair of gene lists i and j, with the following structure:

     $l2

     $l2$l1$t21

     $l3

     $l3$l1$t31, $l3$l2$t32

     ...

     $lk$l1$tk1, $lk$l2$tk2, ..., $lk$l(k-1)tk(k-1)

     If &#x27;x&#x27; is an object of class &quot;tableList&quot;, the test is performed
     over each one of these tables.

     The test is based on the fact that the studentized statistic (^d -
     d) / ^se is approximately distributed as a standard normal. ^d
     stands for the sample Sorensen-Dice dissimilarity, d for its true
     (unknown) value and ^se for the estimate of its standard error.
     This result is asymptotically correct, but the true distribution
     of the studentized statistic is not exactly normal for finite
     samples, with a heavier left tail than expected under the Gaussian
     model, which may produce some type I error inflation. The
     bootstrap method provides a better approximation to this
     distribution. In the bootstrap approach, &#x27;nboot&#x27; new bootstrap
     contingency tables are generated from a multinomial distribution
     with parameters &#x27;size =&#x27; (n11 + n01 + n10 + n00) and probabilities
     %. Sometimes, some of these generated tables may present so low
     frequencies of enrichment that make them unable for Sorensen-Dice
     computations. As a consequence, the number of effective bootstrap
     samples may be lower than the number of initially planned ones,
     &#x27;nboot&#x27;, but our simulation studies concluded that this makes the
     test more conservative, less prone to reject a truly false null
     hypothesis of inequivalence, but in any case protects from
     inflating the type I error.

     In a bootstrap test result, use &#x27;getNboot&#x27; to access the number of
     initially planned bootstrap replicates and &#x27;getEffNboot&#x27; to access
     the number of finally effective bootstrap replicates.

_V_a_l_u_e:

     For all interfaces (except for the &quot;list&quot; and &quot;tableList&quot;
     interfaces) the result is a list of class &quot;equivSDhtest&quot; which
     inherits from &quot;htest&quot;, with the following components:

     statistic the value of the studentized statistic (dSorensen(x) -
          d0) / seSorensen(x)

     p.value the p-value of the test

     conf.int the one-sided confidence interval (0, dUpp]

     estimate the Sorensen dissimilarity estimate, dSorensen(x)

     null.value the value of d0

     stderr the standard error of the Sorensen dissimilarity estimate,
          seSorensen(x), used as denominator in the studentized
          statistic

     alternative a character string describing the alternative
          hypothesis

     method a character string describing the test

     data.name a character string giving the names of the data

     enrichTab the 2x2 contingency table of joint enrichment whereby
          the test was based

     For the &quot;list&quot; and &quot;tableList&quot; interfaces, the result is an
     &quot;equivSDhtestList&quot;, a list of objects with all pairwise
     comparisons, each one being an object of &quot;equivSDhtest&quot; class.

_M_e_t_h_o_d_s (_b_y _c_l_a_s_s):

        • &#x27;table&#x27;: S3 method for class &quot;table&quot;

        • &#x27;matrix&#x27;: S3 method for class &quot;matrix&quot;

        • &#x27;numeric&#x27;: S3 method for class &quot;numeric&quot;

        • &#x27;character&#x27;: S3 method for class &quot;character&quot;

        • &#x27;list&#x27;: S3 method for class &quot;list&quot;

        • &#x27;tableList&#x27;: S3 method for class &quot;tableList&quot;

_S_e_e _A_l_s_o:

     &#x27;nice2x2Table&#x27; for checking and reformatting data, &#x27;dSorensen&#x27; for
     computing the Sorensen-Dice dissimilarity, &#x27;seSorensen&#x27; for
     computing the standard error of the dissimilarity, &#x27;duppSorensen&#x27;
     for the upper limit of a one-sided confidence interval of the
     dissimilarity. &#x27;getTable&#x27;, &#x27;getPvalue&#x27;, &#x27;getUpper&#x27;, &#x27;getSE&#x27;,
     &#x27;getNboot&#x27; and &#x27;getEffNboot&#x27; for accessing specific fields in the
     result of these testing functions. &#x27;update&#x27; for updating the
     result of these testing functions with alternative equivalence
     limits, confidence levels or to convert a normal result in a
     bootstrap result or the reverse.

_E_x_a_m_p_l_e_s:

     # Gene lists &#x27;atlas&#x27; and &#x27;sanger&#x27; in &#x27;allOncoGeneLists&#x27; dataset. Table of joint enrichment
     # of GO items in ontology BP at level 3.
     data(tab_atlas.sanger_BP3)
     tab_atlas.sanger_BP3
     equivTestSorensen(tab_atlas.sanger_BP3)
     # Bootstrap test:
     equivTestSorensen(tab_atlas.sanger_BP3, boot = TRUE)
     
     # Equivalence tests from scratch, directly from gene lists:
     # (These examples may be considerably time consuming due to many enrichment
     # tests to build the contingency tables of mutual enrichment)
     # ?pbtGeneLists
     # Gene universe:
     # data(humanEntrezIDs)
     # equivTestSorensen(pbtGeneLists[[&quot;IRITD3&quot;]], pbtGeneLists[[&quot;IRITD5&quot;]],
     #                   geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;,
     #                   onto = &quot;CC&quot;, GOLevel = 5)
     # Bootstrap instead of normal approximation test:
     # equivTestSorensen(pbtGeneLists[[&quot;IRITD3&quot;]], pbtGeneLists[[&quot;IRITD5&quot;]],
     #                   geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;,
     #                   onto = &quot;CC&quot;, GOLevel = 5,
     #                   boot = TRUE)
     
     # Essentially, the above code makes:
     # IRITD3vs5.CC5 &lt;- buildEnrichTable(pbtGeneLists[[&quot;IRITD3&quot;]], pbtGeneLists[[&quot;IRITD5&quot;]],
     #                                   geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;,
     #                                   onto = &quot;CC&quot;, GOLevel = 5)
     # IRITD3vs5.CC5
     # equivTestSorensen(IRITD3vs5.CC5)
     # equivTestSorensen(IRITD3vs5.CC5, boot = TRUE)
     # (Note that building first the contingency table may be advantageous to save time!)
     
     # All pairwise equivalence tests:
     # equivTestSorensen(pbtGeneLists,
     #                   geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;,
     #                   onto = &quot;CC&quot;, GOLevel = 5)
     
     
     # Equivalence test on a contingency table represented as a numeric vector:
     equivTestSorensen(c(56, 1, 30, 47))
     equivTestSorensen(c(56, 1, 30, 47), boot = TRUE)
     equivTestSorensen(c(56, 1, 30))
     # Error: all frequencies are needed for bootstrap:
     try(equivTestSorensen(c(56, 1, 30), boot = TRUE), TRUE)
     

&gt; equiv.atlas.sanger &lt;- equivTestSorensen(tab_atlas.sanger_BP3)
&gt; equiv.atlas.sanger

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab_atlas.sanger_BP3
(d - d0) / se = -5.9551, p-value = 1.3e-09
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.2796658
sample estimates:
Sorensen dissimilarity 
             0.2167832 
attr(,&quot;se&quot;)
standard error 
    0.03822987 

&gt; getTable(equiv.atlas.sanger)
                 Enriched in sanger
Enriched in atlas TRUE FALSE
            TRUE    56    30
            FALSE    1   471
&gt; getPvalue(equiv.atlas.sanger)
     p-value 
1.299869e-09 
&gt; 
&gt; tryCatch(equivTestSorensen(badConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(x): Not a 2x2 table&gt;
&gt; tryCatch(equivTestSorensen(incompleteConti), error = function(e) {return(e)})
&lt;simpleError in nice2x2Table.table(x): Not a 2x2 table&gt;
&gt; equivTestSorensen(contiAsVector)

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  contiAsVector
(d - d0) / se = 3.5287, p-value = 0.9998
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6937071
sample estimates:
Sorensen dissimilarity 
             0.6144578 
attr(,&quot;se&quot;)
standard error 
    0.04818012 

&gt; equivTestSorensen(contiAsVector.mat)

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  contiAsVector.mat
(d - d0) / se = 3.5287, p-value = 0.9998
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6937071
sample estimates:
Sorensen dissimilarity 
             0.6144578 
attr(,&quot;se&quot;)
standard error 
    0.04818012 

&gt; set.seed(123)
&gt; equivTestSorensen(contiAsVector.mat, boot = TRUE)

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  contiAsVector.mat
(d - d0) / se = 3.5287, p-value = 0.9996
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6922658
sample estimates:
Sorensen dissimilarity 
             0.6144578 
attr(,&quot;se&quot;)
standard error 
    0.04818012 

&gt; equivTestSorensen(contiAsVectorLen3)

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  contiAsVectorLen3
(d - d0) / se = 3.5287, p-value = 0.9998
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6937071
sample estimates:
Sorensen dissimilarity 
             0.6144578 
attr(,&quot;se&quot;)
standard error 
    0.04818012 

&gt; 
&gt; tryCatch(equivTestSorensen(contiAsVectorLen3, boot = TRUE), error = function(e) {return(e)})
&lt;simpleError in equivTestSorensen.numeric(contiAsVectorLen3, boot = TRUE): Bootstraping requires a numeric vector of 4 frequencies&gt;
&gt; 
&gt; equivTestSorensen(c(0,0,0,45))

	No test performed due non finite (d - d0) / se statistic

data:  c(0, 0, 0, 45)
(d - d0) / se = NaN, p-value = NA
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
   0 NaN
sample estimates:
Sorensen dissimilarity 
                   NaN 
attr(,&quot;se&quot;)
standard error 
           NaN 

&gt; 
&gt; # Sorensen-Dice computations from scratch, directly from gene lists
&gt; data(allOncoGeneLists)
&gt; ?allOncoGeneLists
allOncoGeneLists          package:goSorensen           R Documentation

_7 _g_e_n_e _l_i_s_t_s _p_o_s_s_i_b_l_y _r_e_l_a_t_e_d _w_i_t_h _c_a_n_c_e_r

_D_e_s_c_r_i_p_t_i_o_n:

     An object of class &quot;list&quot; of length 7. Each one of its elements is
     a &quot;character&quot; vector of gene identifiers. Only gene lists of
     length almost 100 were taken from their source web. Take these
     lists just as an illustrative example, they are not automatically
     updated.

_U_s_a_g_e:

     data(allOncoGeneLists)
     
_F_o_r_m_a_t:

     An object of class &quot;list&quot; of length 7. Each one of its elements is
     a &quot;character&quot; vector of gene identifiers.

_S_o_u_r_c_e:

     &lt;http://www.bushmanlab.org/links/genelists&gt;


&gt; data(humanEntrezIDs)
&gt; # First, the mutual GO node enrichment tables are built, then computations
&gt; # proceed from these contingency tables.
&gt; # Building the contingency tables is a slow process (many enrichment tests)
&gt; normTest &lt;- equivTestSorensen(allOncoGeneLists[[&quot;atlas&quot;]], allOncoGeneLists[[&quot;sanger&quot;]],
+                               listNames = c(&quot;atlas&quot;, &quot;sanger&quot;),
+                               onto = &quot;BP&quot;, GOLevel = 5,
+                               geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; normTest

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -8.0329, p-value = 4.758e-16
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3567572
sample estimates:
Sorensen dissimilarity 
             0.3341788 
attr(,&quot;se&quot;)
standard error 
    0.01372669 

&gt; 
&gt; # To perform a bootstrap test from scratch would be even slower:
&gt; # set.seed(123)
&gt; # bootTest &lt;- equivTestSorensen(allOncoGeneLists[[&quot;atlas&quot;]], allOncoGeneLists[[&quot;sanger&quot;]],
&gt; #                               listNames = c(&quot;atlas&quot;, &quot;sanger&quot;),
&gt; #                               boot = TRUE,
&gt; #                               onto = &quot;BP&quot;, GOLevel = 5,
&gt; #                               geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; # bootTest
&gt; 
&gt; # It is much faster to upgrade &#x27;normTest&#x27; to be a bootstrap test:
&gt; set.seed(123)
&gt; bootTest &lt;- upgrade(normTest, boot = TRUE)
&gt; bootTest

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -8.0329, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.000000 0.357055
sample estimates:
Sorensen dissimilarity 
             0.3341788 
attr(,&quot;se&quot;)
standard error 
    0.01372669 

&gt; # To know the number of planned bootstrap replicates:
&gt; getNboot(bootTest)
[1] 10000
&gt; # To know the number of valid bootstrap replicates:
&gt; getEffNboot(bootTest)
[1] 10000
&gt; 
&gt; # There are similar methods for dSorensen, seSorensen, duppSorensen, etc. to
&gt; # compute directly from a pair of gene lists.
&gt; # They are quite slow for the same reason as before (many enrichment tests).
&gt; # dSorensen(allOncoGeneLists[[&quot;atlas&quot;]], allOncoGeneLists[[&quot;sanger&quot;]],
&gt; #           listNames = c(&quot;atlas&quot;, &quot;sanger&quot;),
&gt; #           onto = &quot;BP&quot;, GOLevel = 5,
&gt; #           geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; # seSorensen(allOncoGeneLists[[&quot;atlas&quot;]], allOncoGeneLists[[&quot;sanger&quot;]],
&gt; #            listNames = c(&quot;atlas&quot;, &quot;sanger&quot;),
&gt; #            onto = &quot;BP&quot;, GOLevel = 5,
&gt; #            geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; #
&gt; # duppSorensen(allOncoGeneLists[[&quot;atlas&quot;]], allOncoGeneLists[[&quot;sanger&quot;]],
&gt; #              listNames = c(&quot;atlas&quot;, &quot;sanger&quot;),
&gt; #              onto = &quot;BP&quot;, GOLevel = 5,
&gt; #              geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; #
&gt; # set.seed(123)
&gt; # duppSorensen(allOncoGeneLists[[&quot;atlas&quot;]], allOncoGeneLists[[&quot;sanger&quot;]],
&gt; #              boot = TRUE,
&gt; #              listNames = c(&quot;atlas&quot;, &quot;sanger&quot;),
&gt; #              onto = &quot;BP&quot;, GOLevel = 5,
&gt; #              geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; # etc.
&gt; 
&gt; # To build the contingency table first and then compute from it, may be a more flexible
&gt; # and saving time strategy, in general:
&gt; ?buildEnrichTable
buildEnrichTable          package:goSorensen           R Documentation

_C_r_e_a_t_e_s _a _2_x_2 _e_n_r_i_c_h_m_e_n_t _c_o_n_t_i_n_g_e_n_c_y _t_a_b_l_e _f_r_o_m _t_w_o _g_e_n_e _l_i_s_t_s, _o_r _a_l_l
_p_a_i_r_w_i_s_e _c_o_n_t_i_n_g_e_n_c_y _t_a_b_l_e_s _f_o_r _a &quot;_l_i_s_t&quot; _o_f _g_e_n_e _l_i_s_t_s.

_D_e_s_c_r_i_p_t_i_o_n:

     Creates a 2x2 enrichment contingency table from two gene lists, or
     all pairwise contingency tables for a &quot;list&quot; of gene lists.

_U_s_a_g_e:

     buildEnrichTable(x, ...)
     
     ## Default S3 method:
     buildEnrichTable(
       x,
       y,
       listNames = c(&quot;gene.list1&quot;, &quot;gene.list2&quot;),
       check.table = TRUE,
       geneUniverse,
       orgPackg,
       onto,
       GOLevel,
       restricted = FALSE,
       pAdjustMeth = &quot;BH&quot;,
       pvalCutoff = 0.01,
       qvalCutoff = 0.05,
       ...
     )
     
     ## S3 method for class &#x27;character&#x27;
     buildEnrichTable(
       x,
       y,
       listNames = c(&quot;gene.list1&quot;, &quot;gene.list2&quot;),
       check.table = TRUE,
       geneUniverse,
       orgPackg,
       onto,
       GOLevel,
       restricted = FALSE,
       pAdjustMeth = &quot;BH&quot;,
       pvalCutoff = 0.01,
       qvalCutoff = 0.05,
       ...
     )
     
     ## S3 method for class &#x27;list&#x27;
     buildEnrichTable(
       x,
       check.table = TRUE,
       geneUniverse,
       orgPackg,
       onto,
       GOLevel,
       restricted = FALSE,
       pAdjustMeth = &quot;BH&quot;,
       pvalCutoff = 0.01,
       qvalCutoff = 0.05,
       parallel = FALSE,
       nOfCores = min(detectCores() - 1, length(x) - 1),
       ...
     )
     
_A_r_g_u_m_e_n_t_s:

       x: either an object of class &quot;character&quot; (or coerzable to
          &quot;character&quot;) representing a vector of gene identifiers or an
          object of class &quot;list&quot;. In this second case, each element of
          the list must be a &quot;character&quot; vector of gene identifiers.
          Then, all pairwise contingency tables between these gene
          lists are built.

     ...: Additional parameters for internal use (not used for the
          moment)

       y: an object of class &quot;character&quot; (or coerzable to &quot;character&quot;)
          representing a vector of gene identifiers.

listNames: a character(2) with the gene lists names originating the
          cross-tabulated enrichment frequencies.

check.table: Logical The resulting table must be checked. Defaults to
          TRUE.

geneUniverse: character vector containing all genes from where
          geneLists have been extracted.

orgPackg: A string with the name of the annotation package.

    onto: string describing the ontology. Either &quot;BP&quot;, &quot;MF&quot; or &quot;CC&quot;.

 GOLevel: An integer, the GO ontology level.

restricted: Logical variable to decide how tabulation of GOIDs is
          performed. Defaults to FALSE. See the details section.

pAdjustMeth: string describing the adjust method, either &quot;BH&quot;, &quot;BY&quot; or
          &quot;Bonf&quot;, defaults to &#x27;BH&#x27;.

pvalCutoff: A numeric value. Defaults to 0.01.

qvalCutoff: A numeric value. Defaults to 0.05.

parallel: Logical. Defaults to FALSE but put it at TRUE for parallel
          computation.

nOfCores: Number of cores for parallel computations. Only in &quot;list&quot;
          interface.

_D_e_t_a_i_l_s:

     Unrestricted tabulation crosses _all_ GO Terms located at the
     level indicated by `GOLev` with the two GOIDs lists. Restricted
     tabulation crosses only terms from the selected GO level that are
     _common to ancestor terms of either list_. That is, if one term in
     the selected GO level is not an ancestor of at least one of the
     gene list most specific GO terms it is excluded from the GO
     Level&#x27;s terms because it is impossible that it appears as being
     enriched.

_V_a_l_u_e:

     in the &quot;character&quot; interface, an object of class &quot;table&quot; is
     returned. It represents a 2x2 contingency table interpretable as
     the cross-tabulation of the enriched GO items in two gene lists:
     &quot;Number of enriched items in list 1 (TRUE, FALSE)&quot; x &quot;Number of
     enriched items in list 2 (TRUE, FALSE)&quot;. In the &quot;list&quot; interface,
     the result is an object of class &quot;tableList&quot; with all pairwise
     tables. Class &quot;tableList&quot; corresponds to objects representing all
     mutual enrichment contingency tables generated in a pairwise
     fashion: Given gene lists (i.e. &quot;character&quot; vectors of gene
     identifiers) l1, l2, ..., lk, an object of class &quot;tableList&quot; is a
     list of lists of contingency tables t(i,j) generated from each
     pair of gene lists i and j, with the following structure:

     $l2

     $l2$l1$t(2,1)

     $l3

     $l3$l1$t(3,1), $l3$l2$t(3,2)

     ...

     $lk

     $lk$l1$t(k,1), $lk$l2$t(k,2), ..., $lk$l(k-1)t(K,k-1)

_M_e_t_h_o_d_s (_b_y _c_l_a_s_s):

        • &#x27;default&#x27;: S3 default method

        • &#x27;character&#x27;: S3 method for class &quot;character&quot;

        • &#x27;list&#x27;: S3 method for class &quot;list&quot;

_E_x_a_m_p_l_e_s:

     # Gene universe:
     data(humanEntrezIDs)
     # Gene lists to be explored for enrichment:
     data(allOncoGeneLists)
     ?allOncoGeneLists
     # Table of mutual GO node enrichment between gene lists Vogelstein and sanger,
     # for ontology MF at GO level 6 (only first 50 genes, to improve speed).
     vog.VS.sang &lt;- buildEnrichTable(allOncoGeneLists[[&quot;Vogelstein&quot;]][seq_len(50)],
                                     allOncoGeneLists[[&quot;sanger&quot;]][seq_len(50)],
                                     geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;,
                                     onto = &quot;MF&quot;, GOLevel = 6, listNames = c(&quot;Vogelstein&quot;, &quot;sanger&quot;))
     vog.VS.sang
     # This is an inadequate table for Sorensen-Dice computations:
     equivTestSorensen(vog.VS.sang)
     # This sometimes happens, due too small gene lists or due to poor incidence
     # of enrichment.
     #
     # In fact, the complete gene lists generate a much interesting contingency table:
     # vog.VS.sang &lt;- buildEnrichTable(allOncoGeneLists[[&quot;Vogelstein&quot;]],
     #                                 allOncoGeneLists[[&quot;sanger&quot;]],
     #                                 geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;,
     #                                 onto = &quot;MF&quot;, GOLevel = 6, listNames = c(&quot;Vogelstein&quot;, &quot;sanger&quot;))
     # vog.VS.sang
     # equivTestSorensen(vog.VS.sang)
     

&gt; tab &lt;- buildEnrichTable(allOncoGeneLists[[&quot;atlas&quot;]], allOncoGeneLists[[&quot;sanger&quot;]],
+                         listNames = c(&quot;atlas&quot;, &quot;sanger&quot;),
+                         onto = &quot;BP&quot;, GOLevel = 5,
+                         geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; 
&gt; tab
                 Enriched in sanger
Enriched in atlas TRUE FALSE
            TRUE   525   477
            FALSE   50  9096
&gt; 
&gt; # (Here, an obvious faster possibility would be to recover the enrichment contingency
&gt; # table from the previous normal test result:)
&gt; tab &lt;- getTable(normTest)
&gt; tab
                 Enriched in sanger
Enriched in atlas TRUE FALSE
            TRUE   525   477
            FALSE   50  9096
&gt; 
&gt; tst &lt;- equivTestSorensen(tab)
&gt; tst

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -8.0329, p-value = 4.758e-16
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3567572
sample estimates:
Sorensen dissimilarity 
             0.3341788 
attr(,&quot;se&quot;)
standard error 
    0.01372669 

&gt; set.seed(123)
&gt; bootTst &lt;- equivTestSorensen(tab, boot = TRUE)
&gt; bootTst

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -8.0329, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.000000 0.357055
sample estimates:
Sorensen dissimilarity 
             0.3341788 
attr(,&quot;se&quot;)
standard error 
    0.01372669 

&gt; 
&gt; dSorensen(tab)
[1] 0.3341788
&gt; seSorensen(tab)
[1] 0.01372669
&gt; # or:
&gt; getDissimilarity(tst)
Sorensen dissimilarity 
             0.3341788 
attr(,&quot;se&quot;)
standard error 
    0.01372669 
&gt; 
&gt; duppSorensen(tab)
[1] 0.3567572
&gt; getUpper(tst)
   dUpper 
0.3567572 
&gt; 
&gt; set.seed(123)
&gt; duppSorensen(tab, boot = TRUE)
[1] 0.357055
attr(,&quot;eff.nboot&quot;)
[1] 10000
&gt; getUpper(bootTst)
  dUpper 
0.357055 
&gt; 
&gt; # To perform from scratch all pairwise tests (or other Sorensen-Dice computations)
&gt; # is even much slower. For example, all pairwise...
&gt; # Dissimilarities:
&gt; # # allPairDiss &lt;- dSorensen(allOncoGeneLists,
&gt; # #                          onto = &quot;BP&quot;, GOLevel = 5,
&gt; # #                          geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; # # allPairDiss
&gt; #
&gt; # # Still time consuming but faster: build all tables computing in parallel:
&gt; # allPairDiss &lt;- dSorensen(allOncoGeneLists,
&gt; #                          onto = &quot;BP&quot;, GOLevel = 5,
&gt; #                          geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;,
&gt; #                          parallel = TRUE)
&gt; # allPairDiss
&gt; 
&gt; # Standard errors:
&gt; # seSorensen(allOncoGeneLists,
&gt; #            onto = &quot;BP&quot;, GOLevel = 5,
&gt; #            geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; #
&gt; # Upper confidence interval limits:
&gt; # duppSorensen(allOncoGeneLists,
&gt; #              onto = &quot;BP&quot;, GOLevel = 5,
&gt; #              geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; # All pairwise asymptotic normal tests:
&gt; # allTests &lt;- equivTestSorensen(allOncoGeneLists,
&gt; #                               onto = &quot;BP&quot;, GOLevel = 5,
&gt; #                               geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; # getPvalue(allTests, simplify = FALSE)
&gt; # getPvalue(allTests)
&gt; # p.adjust(getPvalue(allTests), method = &quot;holm&quot;)
&gt; # To perform all pairwise bootstrap tests from scratch is (slightly)
&gt; # even more time consuming:
&gt; # set.seed(123)
&gt; # allBootTests &lt;- equivTestSorensen(allOncoGeneLists,
&gt; #                                   boot = TRUE,
&gt; #                                   onto = &quot;BP&quot;, GOLevel = 5,
&gt; #                                   geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; # Not all bootstrap replicates may conduct to finite statistics:
&gt; # getNboot(allBootTests)
&gt; 
&gt; # Given the normal tests (object &#x27;allTests&#x27;), it is much faster to upgrade
&gt; # it to have the bootstrap tests:
&gt; # set.seed(123)
&gt; # allBootTests &lt;- upgrade(allTests, boot = TRUE)
&gt; # getPvalue(allBootTests, simplify = FALSE)
&gt; 
&gt; # Again, the faster and more flexible possibility may be:
&gt; # 1) First, build all pairwise enrichment contingency tables (slow first step):
&gt; # allTabsBP.4 &lt;- buildEnrichTable(allOncoGeneLists,
&gt; #                                 onto = &quot;BP&quot;, GOLevel = 5,
&gt; #                                 geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; # allTabsBP.4
&gt; 
&gt; # Better, directly use the dataset available at this package, goSorensen:
&gt; data(allTabsBP.4)
&gt; allTabsBP.4
$cangenes
$cangenes$atlas
                    Enriched in atlas
Enriched in cangenes TRUE FALSE
               TRUE     1     0
               FALSE  959  9397


$cis
$cis$atlas
               Enriched in atlas
Enriched in cis TRUE FALSE
          TRUE   181    11
          FALSE  779  9386

$cis$cangenes
               Enriched in cangenes
Enriched in cis  TRUE FALSE
          TRUE      1   191
          FALSE     0 10165


$miscellaneous
$miscellaneous$atlas
                         Enriched in atlas
Enriched in miscellaneous TRUE FALSE
                    TRUE   450    57
                    FALSE  510  9340

$miscellaneous$cangenes
                         Enriched in cangenes
Enriched in miscellaneous TRUE FALSE
                    TRUE     1   506
                    FALSE    0  9850

$miscellaneous$cis
                         Enriched in cis
Enriched in miscellaneous TRUE FALSE
                    TRUE   145   362
                    FALSE   47  9803


$sanger
$sanger$atlas
                  Enriched in atlas
Enriched in sanger TRUE FALSE
             TRUE   500    45
             FALSE  460  9352

$sanger$cangenes
                  Enriched in cangenes
Enriched in sanger TRUE FALSE
             TRUE     1   544
             FALSE    0  9812

$sanger$cis
                  Enriched in cis
Enriched in sanger TRUE FALSE
             TRUE   153   392
             FALSE   39  9773

$sanger$miscellaneous
                  Enriched in miscellaneous
Enriched in sanger TRUE FALSE
             TRUE   359   186
             FALSE  148  9664


$Vogelstein
$Vogelstein$atlas
                      Enriched in atlas
Enriched in Vogelstein TRUE FALSE
                 TRUE   542    76
                 FALSE  418  9321

$Vogelstein$cangenes
                      Enriched in cangenes
Enriched in Vogelstein TRUE FALSE
                 TRUE     1   617
                 FALSE    0  9739

$Vogelstein$cis
                      Enriched in cis
Enriched in Vogelstein TRUE FALSE
                 TRUE   163   455
                 FALSE   29  9710

$Vogelstein$miscellaneous
                      Enriched in miscellaneous
Enriched in Vogelstein TRUE FALSE
                 TRUE   374   244
                 FALSE  133  9606

$Vogelstein$sanger
                      Enriched in sanger
Enriched in Vogelstein TRUE FALSE
                 TRUE   512   106
                 FALSE   33  9706


$waldman
$waldman$atlas
                   Enriched in atlas
Enriched in waldman TRUE FALSE
              TRUE   641   138
              FALSE  319  9259

$waldman$cangenes
                   Enriched in cangenes
Enriched in waldman TRUE FALSE
              TRUE     1   778
              FALSE    0  9578

$waldman$cis
                   Enriched in cis
Enriched in waldman TRUE FALSE
              TRUE   171   608
              FALSE   21  9557

$waldman$miscellaneous
                   Enriched in miscellaneous
Enriched in waldman TRUE FALSE
              TRUE   467   312
              FALSE   40  9538

$waldman$sanger
                   Enriched in sanger
Enriched in waldman TRUE FALSE
              TRUE   446   333
              FALSE   99  9479

$waldman$Vogelstein
                   Enriched in Vogelstein
Enriched in waldman TRUE FALSE
              TRUE   488   291
              FALSE  130  9448


attr(,&quot;class&quot;)
[1] &quot;tableList&quot; &quot;list&quot;     
&gt; class(allTabsBP.4)
[1] &quot;tableList&quot; &quot;list&quot;     
&gt; # 2) Then perform all required computatios from these enrichment contingency tables...
&gt; # All pairwise tests:
&gt; allTests &lt;- equivTestSorensen(allTabsBP.4)
&gt; allTests
$cangenes
$cangenes$atlas

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 266.22, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
             0.9979188 
attr(,&quot;se&quot;)
standard error 
      0.002079 



$cis
$cis$atlas

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 13.583, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.7149878
sample estimates:
Sorensen dissimilarity 
             0.6857639 
attr(,&quot;se&quot;)
standard error 
    0.01776688 


$cis$cangenes

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 52.885, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
             0.9896373 
attr(,&quot;se&quot;)
standard error 
      0.010309 



$miscellaneous
$miscellaneous$atlas

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -3.8685, p-value = 5.474e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.000000 0.411139
sample estimates:
Sorensen dissimilarity 
             0.3865031 
attr(,&quot;se&quot;)
standard error 
    0.01497758 


$miscellaneous$cangenes

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 140.39, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
              0.996063 
attr(,&quot;se&quot;)
standard error 
   0.003929258 


$miscellaneous$cis

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 5.9904, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.000000 0.623749
sample estimates:
Sorensen dissimilarity 
             0.5851216 
attr(,&quot;se&quot;)
standard error 
    0.02348381 



$sanger
$sanger$atlas

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -7.738, p-value = 5.051e-15
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3586962
sample estimates:
Sorensen dissimilarity 
             0.3355482 
attr(,&quot;se&quot;)
standard error 
    0.01407301 


$sanger$cangenes

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 150.94, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
              0.996337 
attr(,&quot;se&quot;)
standard error 
   0.003656295 


$sanger$cis

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 6.1374, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6224203
sample estimates:
Sorensen dissimilarity 
             0.5848033 
attr(,&quot;se&quot;)
standard error 
    0.02286957 


$sanger$miscellaneous

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -7.701, p-value = 6.75e-15
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3446065
sample estimates:
Sorensen dissimilarity 
             0.3174905 
attr(,&quot;se&quot;)
standard error 
    0.01648539 



$Vogelstein
$Vogelstein$atlas

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -9.8173, p-value &lt; 2.2e-16
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3350683
sample estimates:
Sorensen dissimilarity 
             0.3130545 
attr(,&quot;se&quot;)
standard error 
    0.01338347 


$Vogelstein$cangenes

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 171.22, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
              0.996769 
attr(,&quot;se&quot;)
standard error 
   0.003225798 


$Vogelstein$cis

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 7.0238, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6333811
sample estimates:
Sorensen dissimilarity 
             0.5975309 
attr(,&quot;se&quot;)
standard error 
    0.02179538 


$Vogelstein$miscellaneous

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -6.7191, p-value = 9.142e-12
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3618762
sample estimates:
Sorensen dissimilarity 
             0.3351111 
attr(,&quot;se&quot;)
standard error 
    0.01627199 


$Vogelstein$sanger

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -32.259, p-value &lt; 2.2e-16
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.1360863
sample estimates:
Sorensen dissimilarity 
             0.1195185 
attr(,&quot;se&quot;)
standard error 
     0.0100725 



$waldman
$waldman$atlas

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -15.308, p-value &lt; 2.2e-16
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.2823131
sample estimates:
Sorensen dissimilarity 
             0.2627947 
attr(,&quot;se&quot;)
standard error 
    0.01186635 


$waldman$cangenes

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 215.94, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
             0.9974359 
attr(,&quot;se&quot;)
standard error 
   0.002560815 


$waldman$cis

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = 10.327, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6801719
sample estimates:
Sorensen dissimilarity 
             0.6477858 
attr(,&quot;se&quot;)
standard error 
    0.01968936 


$waldman$miscellaneous

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -12.16, p-value &lt; 2.2e-16
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.2968117
sample estimates:
Sorensen dissimilarity 
              0.273717 
attr(,&quot;se&quot;)
standard error 
    0.01404058 


$waldman$sanger

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -7.9582, p-value = 8.729e-16
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3507062
sample estimates:
Sorensen dissimilarity 
              0.326284 
attr(,&quot;se&quot;)
standard error 
    0.01484766 


$waldman$Vogelstein

	Normal asymptotic test for 2x2 contingency tables based on the
	Sorensen-Dice dissimilarity

data:  tab
(d - d0) / se = -10.211, p-value &lt; 2.2e-16
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3244082
sample estimates:
Sorensen dissimilarity 
             0.3013601 
attr(,&quot;se&quot;)
standard error 
    0.01401229 



attr(,&quot;class&quot;)
[1] &quot;equivSDhtestList&quot; &quot;list&quot;            
&gt; class(allTests)
[1] &quot;equivSDhtestList&quot; &quot;list&quot;            
&gt; set.seed(123)
&gt; allBootTests &lt;- equivTestSorensen(allTabsBP.4, boot = TRUE)
&gt; allBootTests
$cangenes
$cangenes$atlas

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (6298 effective bootstrap replicates of 10000)

data:  tab
(d - d0) / se = 266.22, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
             0.9979188 
attr(,&quot;se&quot;)
standard error 
      0.002079 



$cis
$cis$atlas

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = 13.583, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.7143131
sample estimates:
Sorensen dissimilarity 
             0.6857639 
attr(,&quot;se&quot;)
standard error 
    0.01776688 


$cis$cangenes

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (6342 effective bootstrap replicates of 10000)

data:  tab
(d - d0) / se = 52.885, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
             0.9896373 
attr(,&quot;se&quot;)
standard error 
      0.010309 



$miscellaneous
$miscellaneous$atlas

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -3.8685, p-value = 2e-04
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.4111369
sample estimates:
Sorensen dissimilarity 
             0.3865031 
attr(,&quot;se&quot;)
standard error 
    0.01497758 


$miscellaneous$cangenes

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (6382 effective bootstrap replicates of 10000)

data:  tab
(d - d0) / se = 140.39, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
              0.996063 
attr(,&quot;se&quot;)
standard error 
   0.003929258 


$miscellaneous$cis

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = 5.9904, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6245189
sample estimates:
Sorensen dissimilarity 
             0.5851216 
attr(,&quot;se&quot;)
standard error 
    0.02348381 



$sanger
$sanger$atlas

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -7.738, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3588894
sample estimates:
Sorensen dissimilarity 
             0.3355482 
attr(,&quot;se&quot;)
standard error 
    0.01407301 


$sanger$cangenes

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (6401 effective bootstrap replicates of 10000)

data:  tab
(d - d0) / se = 150.94, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
              0.996337 
attr(,&quot;se&quot;)
standard error 
   0.003656295 


$sanger$cis

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = 6.1374, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6222571
sample estimates:
Sorensen dissimilarity 
             0.5848033 
attr(,&quot;se&quot;)
standard error 
    0.02286957 


$sanger$miscellaneous

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -7.701, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3449603
sample estimates:
Sorensen dissimilarity 
             0.3174905 
attr(,&quot;se&quot;)
standard error 
    0.01648539 



$Vogelstein
$Vogelstein$atlas

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -9.8173, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3357311
sample estimates:
Sorensen dissimilarity 
             0.3130545 
attr(,&quot;se&quot;)
standard error 
    0.01338347 


$Vogelstein$cangenes

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (6276 effective bootstrap replicates of 10000)

data:  tab
(d - d0) / se = 171.22, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
              0.996769 
attr(,&quot;se&quot;)
standard error 
   0.003225798 


$Vogelstein$cis

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = 7.0238, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6328101
sample estimates:
Sorensen dissimilarity 
             0.5975309 
attr(,&quot;se&quot;)
standard error 
    0.02179538 


$Vogelstein$miscellaneous

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -6.7191, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3629782
sample estimates:
Sorensen dissimilarity 
             0.3351111 
attr(,&quot;se&quot;)
standard error 
    0.01627199 


$Vogelstein$sanger

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -32.259, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.000000 0.136948
sample estimates:
Sorensen dissimilarity 
             0.1195185 
attr(,&quot;se&quot;)
standard error 
     0.0100725 



$waldman
$waldman$atlas

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -15.308, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.2826499
sample estimates:
Sorensen dissimilarity 
             0.2627947 
attr(,&quot;se&quot;)
standard error 
    0.01186635 


$waldman$cangenes

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (6278 effective bootstrap replicates of 10000)

data:  tab
(d - d0) / se = 215.94, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0 1
sample estimates:
Sorensen dissimilarity 
             0.9974359 
attr(,&quot;se&quot;)
standard error 
   0.002560815 


$waldman$cis

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = 10.327, p-value = 1
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.6796177
sample estimates:
Sorensen dissimilarity 
             0.6477858 
attr(,&quot;se&quot;)
standard error 
    0.01968936 


$waldman$miscellaneous

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -12.16, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.2973298
sample estimates:
Sorensen dissimilarity 
              0.273717 
attr(,&quot;se&quot;)
standard error 
    0.01404058 


$waldman$sanger

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -7.9582, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3515402
sample estimates:
Sorensen dissimilarity 
              0.326284 
attr(,&quot;se&quot;)
standard error 
    0.01484766 


$waldman$Vogelstein

	Bootstrap test for 2x2 contingency tables based on the Sorensen-Dice
	dissimilarity (10000 bootstrap replicates)

data:  tab
(d - d0) / se = -10.211, p-value = 9.999e-05
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
 0.0000000 0.3243615
sample estimates:
Sorensen dissimilarity 
             0.3013601 
attr(,&quot;se&quot;)
standard error 
    0.01401229 



attr(,&quot;class&quot;)
[1] &quot;equivSDhtestList&quot; &quot;list&quot;            
&gt; class(allBootTests)
[1] &quot;equivSDhtestList&quot; &quot;list&quot;            
&gt; getPvalue(allBootTests, simplify = FALSE)
                   atlas cangenes cis miscellaneous    sanger Vogelstein
atlas         0.00000000        1   1    0.00019998 9.999e-05  9.999e-05
cangenes      1.00000000        0   1    1.00000000 1.000e+00  1.000e+00
cis           1.00000000        1   0    1.00000000 1.000e+00  1.000e+00
miscellaneous 0.00019998        1   1    0.00000000 9.999e-05  9.999e-05
sanger        0.00009999        1   1    0.00009999 0.000e+00  9.999e-05
Vogelstein    0.00009999        1   1    0.00009999 9.999e-05  0.000e+00
waldman       0.00009999        1   1    0.00009999 9.999e-05  9.999e-05
                waldman
atlas         9.999e-05
cangenes      1.000e+00
cis           1.000e+00
miscellaneous 9.999e-05
sanger        9.999e-05
Vogelstein    9.999e-05
waldman       0.000e+00
&gt; getEffNboot(allBootTests)
          cangenes.atlas                cis.atlas             cis.cangenes 
                    6298                    10000                     6342 
     miscellaneous.atlas   miscellaneous.cangenes        miscellaneous.cis 
                   10000                     6382                    10000 
            sanger.atlas          sanger.cangenes               sanger.cis 
                   10000                     6401                    10000 
    sanger.miscellaneous         Vogelstein.atlas      Vogelstein.cangenes 
                   10000                    10000                     6276 
          Vogelstein.cis Vogelstein.miscellaneous        Vogelstein.sanger 
                   10000                    10000                    10000 
           waldman.atlas         waldman.cangenes              waldman.cis 
                   10000                     6278                    10000 
   waldman.miscellaneous           waldman.sanger       waldman.Vogelstein 
                   10000                    10000                    10000 
&gt; 
&gt; # To adjust for testing multiplicity:
&gt; p.adjust(getPvalue(allBootTests), method = &quot;holm&quot;)
          cangenes.atlas.p-value                cis.atlas.p-value 
                      1.00000000                       1.00000000 
            cis.cangenes.p-value      miscellaneous.atlas.p-value 
                      1.00000000                       0.00239976 
  miscellaneous.cangenes.p-value        miscellaneous.cis.p-value 
                      1.00000000                       1.00000000 
            sanger.atlas.p-value          sanger.cangenes.p-value 
                      0.00209979                       1.00000000 
              sanger.cis.p-value     sanger.miscellaneous.p-value 
                      1.00000000                       0.00209979 
        Vogelstein.atlas.p-value      Vogelstein.cangenes.p-value 
                      0.00209979                       1.00000000 
          Vogelstein.cis.p-value Vogelstein.miscellaneous.p-value 
                      1.00000000                       0.00209979 
       Vogelstein.sanger.p-value            waldman.atlas.p-value 
                      0.00209979                       0.00209979 
        waldman.cangenes.p-value              waldman.cis.p-value 
                      1.00000000                       1.00000000 
   waldman.miscellaneous.p-value           waldman.sanger.p-value 
                      0.00209979                       0.00209979 
      waldman.Vogelstein.p-value 
                      0.00209979 
&gt; 
&gt; # If only partial statistics are desired:
&gt; dSorensen(allTabsBP.4)
                  atlas  cangenes       cis miscellaneous    sanger Vogelstein
atlas         0.0000000 0.9979188 0.6857639     0.3865031 0.3355482  0.3130545
cangenes      0.9979188 0.0000000 0.9896373     0.9960630 0.9963370  0.9967690
cis           0.6857639 0.9896373 0.0000000     0.5851216 0.5848033  0.5975309
miscellaneous 0.3865031 0.9960630 0.5851216     0.0000000 0.3174905  0.3351111
sanger        0.3355482 0.9963370 0.5848033     0.3174905 0.0000000  0.1195185
Vogelstein    0.3130545 0.9967690 0.5975309     0.3351111 0.1195185  0.0000000
waldman       0.2627947 0.9974359 0.6477858     0.2737170 0.3262840  0.3013601
                waldman
atlas         0.2627947
cangenes      0.9974359
cis           0.6477858
miscellaneous 0.2737170
sanger        0.3262840
Vogelstein    0.3013601
waldman       0.0000000
&gt; duppSorensen(allTabsBP.4)
                  atlas cangenes       cis miscellaneous    sanger Vogelstein
atlas         0.0000000        1 0.7149878     0.4111390 0.3586962  0.3350683
cangenes      1.0000000        0 1.0000000     1.0000000 1.0000000  1.0000000
cis           0.7149878        1 0.0000000     0.6237490 0.6224203  0.6333811
miscellaneous 0.4111390        1 0.6237490     0.0000000 0.3446065  0.3618762
sanger        0.3586962        1 0.6224203     0.3446065 0.0000000  0.1360863
Vogelstein    0.3350683        1 0.6333811     0.3618762 0.1360863  0.0000000
waldman       0.2823131        1 0.6801719     0.2968117 0.3507062  0.3244082
                waldman
atlas         0.2823131
cangenes      1.0000000
cis           0.6801719
miscellaneous 0.2968117
sanger        0.3507062
Vogelstein    0.3244082
waldman       0.0000000
&gt; seSorensen(allTabsBP.4)
                   atlas    cangenes        cis miscellaneous      sanger
atlas         0.00000000 0.002079000 0.01776688   0.014977580 0.014073007
cangenes      0.00207900 0.000000000 0.01030900   0.003929258 0.003656295
cis           0.01776688 0.010309002 0.00000000   0.023483807 0.022869567
miscellaneous 0.01497758 0.003929258 0.02348381   0.000000000 0.016485388
sanger        0.01407301 0.003656295 0.02286957   0.016485388 0.000000000
Vogelstein    0.01338347 0.003225798 0.02179538   0.016271992 0.010072500
waldman       0.01186635 0.002560815 0.01968936   0.014040581 0.014847661
               Vogelstein     waldman
atlas         0.013383469 0.011866345
cangenes      0.003225798 0.002560815
cis           0.021795381 0.019689356
miscellaneous 0.016271992 0.014040581
sanger        0.010072500 0.014847661
Vogelstein    0.000000000 0.014012289
waldman       0.014012289 0.000000000
&gt; 
&gt; 
&gt; # Tipically, in a real study it would be interesting to scan tests
&gt; # along some ontologies and levels inside these ontologies:
&gt; # (which obviously will be a quite slow process)
&gt; # gc()
&gt; # set.seed(123)
&gt; # allBootTests_BP_MF_lev4to8 &lt;- allEquivTestSorensen(allOncoGeneLists,
&gt; #                                                    boot = TRUE,
&gt; #                                                    geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;,
&gt; #                                                    ontos = c(&quot;BP&quot;, &quot;MF&quot;), GOLevels = 4:8)
&gt; # getPvalue(allBootTests_BP_MF_lev4to8)
&gt; # getEffNboot(allBootTests_BP_MF_lev4to8)
&gt; 
&gt; proc.time()
   user  system elapsed 
185.722   2.400 204.901 
</PRE>
</DIV><P><SPAN class="filename">goSorensen.Rcheck/tests/test_nonsense_genes.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R Under development (unstable) (2023-01-14 r83615) -- &quot;Unsuffered Consequences&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; library(goSorensen)



Attaching package: &#x27;goSorensen&#x27;

The following object is masked from &#x27;package:utils&#x27;:

    upgrade

&gt; 
&gt; testError &lt;- function(e) {return(e)}
&gt; 
&gt; tryCatch(dSorensen(&quot;Sec1&quot;, onto = &quot;BP&quot;), error = testError)
&lt;simpleError in buildEnrichTable.character(x, y, check.table = check.table, ...): Argument &#x27;y&#x27; is missing, &#x27;x&#x27; and &#x27;y&#x27; must be &#x27;character&#x27; vectors of valid gene identifiers&gt;
&gt; 
&gt; data(allOncoGeneLists)
&gt; ?allOncoGeneLists
allOncoGeneLists          package:goSorensen           R Documentation

_7 _g_e_n_e _l_i_s_t_s _p_o_s_s_i_b_l_y _r_e_l_a_t_e_d _w_i_t_h _c_a_n_c_e_r

_D_e_s_c_r_i_p_t_i_o_n:

     An object of class &quot;list&quot; of length 7. Each one of its elements is
     a &quot;character&quot; vector of gene identifiers. Only gene lists of
     length almost 100 were taken from their source web. Take these
     lists just as an illustrative example, they are not automatically
     updated.

_U_s_a_g_e:

     data(allOncoGeneLists)
     
_F_o_r_m_a_t:

     An object of class &quot;list&quot; of length 7. Each one of its elements is
     a &quot;character&quot; vector of gene identifiers.

_S_o_u_r_c_e:

     &lt;http://www.bushmanlab.org/links/genelists&gt;


&gt; data(humanEntrezIDs)
&gt; 
&gt; # Non-sense random gene lists. Generating Entrez-like gene identifiers, but random:
&gt; set.seed(1234567)
&gt; genList1 &lt;- unique(as.character(sample.int(99999, size = 100)))
&gt; genList2 &lt;- unique(as.character(sample.int(99999, size = 100)))
&gt; # Gene identifiers are numbers like Entrez identifiers at &#x27;humanEntrezIDs&#x27;, but random.
&gt; dSorensen(genList1, genList2,
+           listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+           onto = &quot;BP&quot;, GOLevel = 5,
+           geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
[1] NaN
&gt; duppSorensen(genList1, genList2,
+              listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+              onto = &quot;BP&quot;, GOLevel = 5,
+              geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
[1] NaN
&gt; seSorensen(genList1, genList2,
+            listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+            onto = &quot;BP&quot;, GOLevel = 5,
+            geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
[1] NaN
&gt; nonSenseTst &lt;- equivTestSorensen(genList1, genList2,
+                                  listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+                                  onto = &quot;BP&quot;, GOLevel = 5,
+                                  geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; nonSenseTst

	No test performed due not finite (d - d0) / se statistic

data:  tab
(d - d0) / se = NaN, p-value = NA
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
   0 NaN
sample estimates:
Sorensen dissimilarity 
                   NaN 
attr(,&quot;se&quot;)
standard error 
           NaN 

&gt; tab &lt;- getTable(nonSenseTst)
&gt; tab
                    Enriched in genList2
Enriched in genList1 TRUE FALSE
               TRUE     0     0
               FALSE    0 10148
&gt; # Or, alternatively:
&gt; tab &lt;- buildEnrichTable(genList1, genList2,
+                         listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+                         onto = &quot;BP&quot;, GOLevel = 5,
+                         geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
&gt; tab
                    Enriched in genList2
Enriched in genList1 TRUE FALSE
               TRUE     0     0
               FALSE    0 10148
&gt; dSorensen(tab)
[1] NaN
&gt; duppSorensen(tab)
[1] NaN
&gt; seSorensen(tab)
[1] NaN
&gt; equivTestSorensen(tab)

	No test performed due not finite (d - d0) / se statistic

data:  tab
(d - d0) / se = NaN, p-value = NA
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
   0 NaN
sample estimates:
Sorensen dissimilarity 
                   NaN 
attr(,&quot;se&quot;)
standard error 
           NaN 

&gt; 
&gt; # Even more non-sense, letters non numeric-style like those at &#x27;humanEntrezIDs&#x27;:
&gt; set.seed(1234567)
&gt; genList1 &lt;- unique(vapply(seq_len(100), function(i) {
+   paste0(sample(c(letters, LETTERS), 6, replace = TRUE), collapse = &quot;&quot;)
+ }, FUN.VALUE = character(1)))
&gt; genList2 &lt;- unique(vapply(seq_len(100), function(i) {
+   paste0(sample(c(letters, LETTERS), 6, replace = TRUE), collapse = &quot;&quot;)
+ }, FUN.VALUE = character(1)))
&gt; 
&gt; # Gene identifiers incompatible with those at &#x27;humanEntrezIDs&#x27;:
&gt; dSorensen(genList1, genList2,
+           listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+           onto = &quot;BP&quot;, GOLevel = 5,
+           geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 3309,8546,222698,2692,284359,56776
--&gt; return NULL...
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 54997,132243,3371,344018,84678,9184
--&gt; return NULL...
[1] NaN
&gt; duppSorensen(genList1, genList2,
+              listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+              onto = &quot;BP&quot;, GOLevel = 5,
+              geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 3007,11144,221400,734,51207,374768
--&gt; return NULL...
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 84225,9825,53405,5819,90780,84056
--&gt; return NULL...
[1] NaN
&gt; seSorensen(genList1, genList2,
+            listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+            onto = &quot;BP&quot;, GOLevel = 5,
+            geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 100137049,151195,23617,5888,4956,128497
--&gt; return NULL...
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 1235,440822,50487,57113,116369,6774
--&gt; return NULL...
[1] NaN
&gt; nonSenseTst &lt;- equivTestSorensen(genList1, genList2,
+                                  listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+                                  onto = &quot;BP&quot;, GOLevel = 5,
+                                  geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 2241,4323,7040,2072,8654,190
--&gt; return NULL...
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 51087,5781,23492,84787,147700,7272
--&gt; return NULL...
&gt; nonSenseTst

	No test performed due not finite (d - d0) / se statistic

data:  tab
(d - d0) / se = NaN, p-value = NA
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
   0 NaN
sample estimates:
Sorensen dissimilarity 
                   NaN 
attr(,&quot;se&quot;)
standard error 
           NaN 

&gt; tab &lt;- getTable(nonSenseTst)
&gt; tab
                    Enriched in genList2
Enriched in genList1 TRUE FALSE
               TRUE     0     0
               FALSE    0 10148
&gt; # Or, alternatively:
&gt; tab &lt;- buildEnrichTable(genList1, genList2,
+                         listNames = c(&quot;genList1&quot;, &quot;genList2&quot;),
+                         onto = &quot;BP&quot;, GOLevel = 5,
+                         geneUniverse = humanEntrezIDs, orgPackg = &quot;org.Hs.eg.db&quot;)
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 578,84464,23230,23626,90,406
--&gt; return NULL...
--&gt; No gene can be mapped....
--&gt; Expected input gene ID: 18,132625,431707,84275,54890,2302
--&gt; return NULL...
&gt; tab
                    Enriched in genList2
Enriched in genList1 TRUE FALSE
               TRUE     0     0
               FALSE    0 10148
&gt; dSorensen(tab)
[1] NaN
&gt; duppSorensen(tab)
[1] NaN
&gt; seSorensen(tab)
[1] NaN
&gt; equivTestSorensen(tab)

	No test performed due not finite (d - d0) / se statistic

data:  tab
(d - d0) / se = NaN, p-value = NA
alternative hypothesis: true equivalence limit d0 is less than 0.4444444
95 percent confidence interval:
   0 NaN
sample estimates:
Sorensen dissimilarity 
                   NaN 
attr(,&quot;se&quot;)
standard error 
           NaN 

&gt; 
&gt; proc.time()
   user  system elapsed 
358.848   5.269 384.574 
</PRE>
</DIV><HR>
<H3>Example timings</H3>
<P><SPAN class="filename">goSorensen.Rcheck/goSorensen-Ex.timings</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<TABLE>
<TR><TD>name</TD><TD style="text-align: right;">user</TD><TD style="text-align: right;">system</TD><TD style="text-align: right;">elapsed
</TD><TR>
<TR><TD>allEquivTestSorensen</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>buildEnrichTable</TD><TD style="text-align: right;">24.519</TD><TD style="text-align: right;"> 1.343</TD><TD style="text-align: right;">27.066</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>dSorensen</TD><TD style="text-align: right;">0.085</TD><TD style="text-align: right;">0.008</TD><TD style="text-align: right;">0.146</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>duppSorensen</TD><TD style="text-align: right;">0.145</TD><TD style="text-align: right;">0.012</TD><TD style="text-align: right;">0.174</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>equivTestSorensen</TD><TD style="text-align: right;">0.205</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.206</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>getDissimilarity</TD><TD style="text-align: right;">0.225</TD><TD style="text-align: right;">0.029</TD><TD style="text-align: right;">0.335</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>getEffNboot</TD><TD style="text-align: right;">1.755</TD><TD style="text-align: right;">0.024</TD><TD style="text-align: right;">2.200</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>getNboot</TD><TD style="text-align: right;">1.824</TD><TD style="text-align: right;">0.005</TD><TD style="text-align: right;">2.339</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>getPvalue</TD><TD style="text-align: right;">0.227</TD><TD style="text-align: right;">0.022</TD><TD style="text-align: right;">0.309</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>getSE</TD><TD style="text-align: right;">0.214</TD><TD style="text-align: right;">0.043</TD><TD style="text-align: right;">0.442</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>getTable</TD><TD style="text-align: right;">0.278</TD><TD style="text-align: right;">0.012</TD><TD style="text-align: right;">0.371</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>getUpper</TD><TD style="text-align: right;">0.240</TD><TD style="text-align: right;">0.015</TD><TD style="text-align: right;">0.316</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>nice2x2Table</TD><TD style="text-align: right;">0.003</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.003</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>pbtAllOntosAndLevels</TD><TD style="text-align: right;">0.102</TD><TD style="text-align: right;">0.012</TD><TD style="text-align: right;">0.129</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>seSorensen</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>upgrade</TD><TD style="text-align: right;">0.698</TD><TD style="text-align: right;">0.096</TD><TD style="text-align: right;">1.044</TD><TD style="text-align: right;">
</TD><TR>
</TABLE>
</DIV></BODY>
</HTML>
