<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>Build/check report for BioC 3.18 - CHECK results for netresponse on kunpeng1</TITLE>
<LINK rel="stylesheet" href="../report.css" type="text/css">
<SCRIPT type="text/javascript" src="../report.js"></SCRIPT>
</HEAD>
<BODY onLoad="initialize();">
<TABLE class="grid_layout" style="width: 100%; background: #EEE;"><TR><TD style="text-align: left; padding: 5px; vertical-align: middle;"><I>Back to <B>Build/check report for BioC 3.18</B>:&nbsp;&nbsp;&nbsp;<A href="../">simplified</A>&nbsp;&nbsp;&nbsp;<A href="../long-report.html">long</A></I></TD><TD><TABLE class="abc_dispatcher"><TR><TD><A href="..#A">A</A></TD><TD><A href="..#B">B</A></TD><TD><A href="..#C">C</A></TD><TD><A href="..#D">D</A></TD><TD><A href="..#E">E</A></TD><TD><A href="..#F">F</A></TD><TD><A href="..#G">G</A></TD><TD><A href="..#H">H</A></TD><TD><A href="..#I">I</A></TD><TD><A href="..#J">J</A></TD><TD><A href="..#K">K</A></TD><TD><A href="..#L">L</A></TD><TD><A href="..#M">M</A></TD><TD><B>[<A href="..#N">N</A>]</B></TD><TD><A href="..#O">O</A></TD><TD><A href="..#P">P</A></TD><TD><A href="..#Q">Q</A></TD><TD><A href="..#R">R</A></TD><TD><A href="..#S">S</A></TD><TD><A href="..#T">T</A></TD><TD><A href="..#U">U</A></TD><TD><A href="..#V">V</A></TD><TD><A href="..#W">W</A></TD><TD><A href="..#X">X</A></TD><TD><A href="..#Y">Y</A></TD><TD><A href="..#Z">Z</A></TD></TR></TABLE></TD></TR></TABLE>
<P class="time_stamp">
This page was generated on 2023-05-16 06:06:59 -0000 (Tue, 16 May 2023).
</P>
<TABLE class="node_specs">
<TR><TH>Hostname</TH><TH>OS</TH><TH>Arch&nbsp;(*)</TH><TH>R&nbsp;version</TH><TH style="text-align: right;">Installed&nbsp;pkgs</TH></TR>
<TR class="kunpeng1"><TD><B><A href="../kunpeng1-NodeInfo.html"><B>kunpeng1</B></A></B></TD><TD>Linux&nbsp;(Ubuntu&nbsp;22.04.1&nbsp;LTS)</TD><TD>aarch64</TD><TD>4.3.0&nbsp;(2023-04-21)&nbsp;--&nbsp;"Already&nbsp;Tomorrow"
</TD><TD style="text-align: right;"><A href="../kunpeng1-R-instpkgs.html">4787</A></TD></TR>
<TR><TD COLSPAN="5" style="font-size: smaller;"><I>Click on any hostname to see more info about the system (e.g. compilers) &nbsp;&nbsp;&nbsp;&nbsp; (*) as reported by 'uname -p', except on Windows and Mac OS X</I></TD></TR>
</TABLE>
<BR>
<H2><SPAN class="kunpeng1">CHECK results for netresponse on kunpeng1</SPAN></H2>
<BR>
<DIV class="motd">
<TABLE><TR><TD>
To the developers/maintainers of the netresponse package:<BR>
- Allow up to 24 hours (and sometimes 48 hours) for your latest push to git@git.bioconductor.org:packages/netresponse.git to reflect on this report. See <A href="%s">Troubleshooting Build Report</A> for more information.<BR><BR>
- Use the following <A href="../Renviron.bioc">Renviron settings</A> to reproduce errors and warnings.<BR><BR>
Note: If "R CMD check" recently failed on the Linux builder over a missing dependency, add the missing dependency to "Suggests" in your DESCRIPTION file. See the <A href="../Renviron.bioc">Renviron.bioc</A> for details.
</TD></TR></TABLE>
</DIV>
<P style="text-align: center;"><A href="raw-results/">raw results</A><P>
<TABLE class="gcard_list">
<TBODY class="gcard ok">
<TR class="header"><TD class="leftmost top_left_corner"></TD><TD>Package <B>1357</B>/2197</TD><TD style="width: 75px;">Hostname</TD><TD style="width: 225px;">OS&nbsp;/&nbsp;Arch</TD><TD class="STAGE install">INSTALL</TD><TD class="STAGE buildsrc">BUILD</TD><TD class="STAGE checksrc selected">CHECK</TD><TD class="STAGE buildbin">BUILD BIN</TD><TD style="width: 12px;"></TD><TD class="rightmost top_right_corner"></TD></TR>
<TR class="selected_row"><TD ROWSPAN="2" class="leftmost bottom_left_corner"></TD><TD ROWSPAN="1" style="vertical-align: top;"><B><A href="./">netresponse</A>&nbsp;1.61.0</B>&nbsp;&nbsp;<SPAN style="font-size: smaller; font-style: italic;">(<A href="/packages/3.18/netresponse">landing page</A>)</SPAN><BR>Leo Lahti<BR><TABLE class="svn_info">
<TR><TD class="svn_info">Snapshot&nbsp;Date:&nbsp;<SPAN class="svn_info">2023-05-13&nbsp;23:12:22&nbsp;-0000&nbsp;(Sat,&nbsp;13&nbsp;May&nbsp;2023)</SPAN></TD></TR>
<TR><TD class="svn_info">git_url:&nbsp;<SPAN class="svn_info">https://git.bioconductor.org/packages/netresponse</SPAN></TD></TR>
<TR><TD class="svn_info">git_branch:&nbsp;<SPAN class="svn_info">devel</SPAN></TD></TR>
<TR><TD class="svn_info">git_last_commit:&nbsp;<SPAN class="svn_info">e2e548e</SPAN></TD></TR>
<TR><TD class="svn_info">git_last_commit_date:&nbsp;<SPAN class="svn_info">2023-04-25&nbsp;14:18:03&nbsp;-0000&nbsp;(Tue,&nbsp;25&nbsp;Apr&nbsp;2023)</SPAN></TD></TR>
</TABLE>
</TD><TD class="kunpeng1 selected"><B>kunpeng1</B></TD><TD class="kunpeng1"><SPAN style="font-size: smaller;">Linux&nbsp;(Ubuntu&nbsp;22.04.1&nbsp;LTS)&nbsp;/&nbsp;aarch64</SPAN></TD><TD class="status kunpeng1 install"><A href="./kunpeng1-install.html" onmouseover="add_class_mouseover(this);" onmouseout="remove_class_mouseover(this);"><SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></A></TD><TD class="status kunpeng1 buildsrc"><A href="./kunpeng1-buildsrc.html" onmouseover="add_class_mouseover(this);" onmouseout="remove_class_mouseover(this);"><SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></A></TD><TD class="status kunpeng1 checksrc selected"><A href="./kunpeng1-checksrc.html" onmouseover="add_class_mouseover(this);" onmouseout="remove_class_mouseover(this);"><SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></A></TD><TD class="status kunpeng1"></TD><TD class="status kunpeng1"></TD><TD ROWSPAN="2" class="rightmost bottom_right_corner"></TD></TR>
<TR class="footer"><TD COLSPAN="8"></TD></TR>
</TBODY>
</TABLE>
<HR>
<H3>Summary</H3>
<DIV class="kunpeng1 hscrollable">
<TABLE>
<TR><TD><B>Package</B>: netresponse</TD></TR>
<TR><TD><B>Version</B>: 1.61.0</TD></TR>
<TR><TD><B>Command</B>: /home/biocbuild/R/R-4.3.0-bin/bin/R CMD check --install=check:netresponse.install-out.txt --library=/home/biocbuild/R/R-4.3.0-bin/site-library --timings netresponse_1.61.0.tar.gz</TD></TR>
<TR><TD><B>StartedAt</B>: 2023-05-15 09:17:37 -0000 (Mon, 15 May 2023)</TD></TR>
<TR><TD><B>EndedAt</B>: 2023-05-15 09:19:06 -0000 (Mon, 15 May 2023)</TD></TR>
<TR><TD><B>EllapsedTime</B>: 89.1 seconds</TD></TR>
<TR><TD><B>RetCode</B>: 0</TD></TR>
<TR><TD><B>Status</B>: <SPAN class="glyph OK">&nbsp;&nbsp;OK&nbsp;&nbsp;</SPAN></TD></TR>
<TR><TD><B>CheckDir</B>: netresponse.Rcheck</TD></TR>
<TR><TD><B>Warnings</B>: 0</TD></TR>
</TABLE>
</DIV>
<HR>
<H3>Command output</H3>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">
##############################################################################
##############################################################################
###
### Running command:
###
###   /home/biocbuild/R/R-4.3.0-bin/bin/R CMD check --install=check:netresponse.install-out.txt --library=/home/biocbuild/R/R-4.3.0-bin/site-library --timings netresponse_1.61.0.tar.gz
###
##############################################################################
##############################################################################


* using log directory ‘/home/biocbuild/bbs-3.18-bioc/meat/netresponse.Rcheck’
* using R version 4.3.0 (2023-04-21)
* using platform: aarch64-unknown-linux-gnu (64-bit)
* R was compiled by
    gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0
    GNU Fortran (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0
* running under: Ubuntu 22.04.2 LTS
* using session charset: UTF-8
* checking for file ‘netresponse/DESCRIPTION’ ... OK
* checking extension type ... Package
* this is package ‘netresponse’ version ‘1.61.0’
* checking package namespace information ... OK
* checking package dependencies ... NOTE
Depends: includes the non-default packages:
  &#x27;BiocStyle&#x27;, &#x27;Rgraphviz&#x27;, &#x27;rmarkdown&#x27;, &#x27;minet&#x27;, &#x27;mclust&#x27;, &#x27;reshape2&#x27;
Adding so many packages to the search path is excessive and importing
selectively is preferable.
* checking if this is a source package ... OK
* checking if there is a namespace ... OK
* checking for hidden files and directories ... OK
* checking for portable file names ... OK
* checking for sufficient/correct file permissions ... OK
* checking whether package ‘netresponse’ can be installed ... OK
* used C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0’
* checking installed package size ... OK
* checking package directory ... OK
* checking ‘build’ directory ... OK
* checking DESCRIPTION meta-information ... OK
* checking top-level files ... OK
* checking for left-over files ... OK
* checking index information ... OK
* checking package subdirectories ... OK
* checking R files for non-ASCII characters ... OK
* checking R files for syntax errors ... OK
* checking whether the package can be loaded ... OK
* checking whether the package can be loaded with stated dependencies ... OK
* checking whether the package can be unloaded cleanly ... OK
* checking whether the namespace can be loaded with stated dependencies ... OK
* checking whether the namespace can be unloaded cleanly ... OK
* checking loading without being on the library search path ... OK
* checking startup messages can be suppressed ... OK
* checking dependencies in R code ... OK
* checking S3 generic/method consistency ... OK
* checking replacement functions ... OK
* checking foreign function calls ... OK
* checking R code for possible problems ... OK
* checking Rd files ... OK
* checking Rd metadata ... OK
* checking Rd cross-references ... OK
* checking for missing documentation entries ... OK
* checking for code/documentation mismatches ... OK
* checking Rd \usage sections ... OK
* checking Rd contents ... OK
* checking for unstated dependencies in examples ... OK
* checking contents of ‘data’ directory ... OK
* checking data for non-ASCII characters ... OK
* checking data for ASCII and uncompressed saves ... OK
* checking line endings in C/C++/Fortran sources/headers ... OK
* checking line endings in Makefiles ... OK
* checking compilation flags in Makevars ... OK
* checking for GNU extensions in Makefiles ... OK
* checking for portable use of $(BLAS_LIBS) and $(LAPACK_LIBS) ... OK
* checking use of PKG_*FLAGS in Makefiles ... OK
* checking compiled code ... NOTE
Note: information on .o files is not available
* checking files in ‘vignettes’ ... OK
* checking examples ... OK
* checking for unstated dependencies in ‘tests’ ... OK
* checking tests ...
  Running ‘bicmixture.R’
  Running ‘mixture.model.test.R’
  Running ‘mixture.model.test.multimodal.R’
  Running ‘mixture.model.test.singlemode.R’
  Running ‘timing.R’
  Running ‘toydata2.R’
  Running ‘validate.netresponse.R’
  Running ‘vdpmixture.R’
 OK
* checking for unstated dependencies in vignettes ... OK
* checking package vignettes in ‘inst/doc’ ... OK
* checking running R code from vignettes ...
  ‘NetResponse.Rmd’ using ‘UTF-8’... OK
 NONE
* checking re-building of vignette outputs ... OK
* checking PDF version of manual ... OK
* DONE

Status: 2 NOTEs
See
  ‘/home/biocbuild/bbs-3.18-bioc/meat/netresponse.Rcheck/00check.log’
for details.


</PRE>
</DIV><HR>
<H3>Installation output</H3>
<P><SPAN class="filename">netresponse.Rcheck/00install.out</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">
##############################################################################
##############################################################################
###
### Running command:
###
###   /home/biocbuild/R/R-4.3.0-bin/bin/R CMD INSTALL netresponse
###
##############################################################################
##############################################################################


* installing to library ‘/home/biocbuild/R/R-4.3.0-bin/site-library’
* installing *source* package ‘netresponse’ ...
** using staged installation
** libs
using C compiler: ‘gcc (Ubuntu 11.3.0-1ubuntu1~22.04) 11.3.0’
gcc -I&quot;/home/biocbuild/R/R-4.3.0-bin/lib/R/include&quot; -DNDEBUG   -I/usr/local/include    -fPIC  -g -O2  -c netresponse.c -o netresponse.o
gcc -shared -L/home/biocbuild/R/R-4.3.0-bin/lib/R/lib -L/usr/local/lib -o netresponse.so netresponse.o -L/home/biocbuild/R/R-4.3.0-bin/lib/R/lib -lR
installing to /home/biocbuild/R/R-4.3.0-bin/site-library/00LOCK-netresponse/00new/netresponse/libs
** R
** data
** inst
** byte-compile and prepare package for lazy loading
** help
*** installing help indices
** building package indices
** installing vignettes
** testing if installed package can be loaded from temporary location
** checking absolute paths in shared objects and dynamic libraries
** testing if installed package can be loaded from final location
** testing if installed package keeps a record of temporary installation path
* DONE (netresponse)
</PRE>
</DIV><HR>
<H3>Tests output</H3>
<P><SPAN class="filename">netresponse.Rcheck/tests/bicmixture.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.3.0 (2023-04-21) -- &quot;Already Tomorrow&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; # 1. vdp.mixt: moodien loytyminen eri dimensiolla, naytemaarilla ja komponenteilla
&gt; #   -&gt; ainakin nopea check
&gt; 
&gt; #######################################################################
&gt; 
&gt; # Generate random data from five Gaussians. 
&gt; # Detect modes with vdp-gm. 
&gt; # Plot data points and detected clusters with variance ellipses
&gt; 
&gt; #######################################################################
&gt; 
&gt; library(netresponse)
Loading required package: BiocStyle
Loading required package: Rgraphviz
Loading required package: graph
Loading required package: BiocGenerics

Attaching package: &#x27;BiocGenerics&#x27;

The following objects are masked from &#x27;package:stats&#x27;:

    IQR, mad, sd, var, xtabs

The following objects are masked from &#x27;package:base&#x27;:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min

Loading required package: grid
Loading required package: rmarkdown

Attaching package: &#x27;rmarkdown&#x27;

The following objects are masked from &#x27;package:BiocStyle&#x27;:

    html_document, md_document, pdf_document

Loading required package: minet
Loading required package: mclust
Package &#x27;mclust&#x27; version 6.0.0
Type &#x27;citation(&quot;mclust&quot;)&#x27; for citing this R package in publications.
Loading required package: reshape2

netresponse (C) 2008-2023 Leo Lahti et al.

https://github.com/antagomir/netresponse
&gt; #source(&quot;~/Rpackages/netresponse/netresponse/R/detect.responses.R&quot;)
&gt; #source(&quot;~/Rpackages/netresponse/netresponse/R/internals.R&quot;)
&gt; #source(&quot;~/Rpackages/netresponse/netresponse/R/vdp.mixt.R&quot;)
&gt; #dyn.load(&quot;/home/tuli/Rpackages/netresponse/netresponse/src/netresponse.so&quot;)
&gt; 
&gt; #########  Generate DATA #############################################
&gt; 
&gt; # Generate Nc components from normal-inverseGamma prior
&gt; 
&gt; set.seed(12346)
&gt; 
&gt; dd &lt;- 3   # Dimensionality of data
&gt; Nc &lt;- 5   # Number of components
&gt; Ns &lt;- 200 # Number of data points
&gt; sd0 &lt;- 3  # component spread
&gt; rgam.shape = 2 # parameters for Gamma distribution 
&gt; rgam.scale = 2 # parameters for Gamma distribution to define precisions
&gt; 
&gt; 
&gt; # Generate means and variances (covariance diagonals) for the components 
&gt; component.means &lt;- matrix(rnorm(Nc*dd, mean = 0, sd = sd0), nrow = Nc, ncol = dd)
&gt; component.vars &lt;- matrix(1/rgamma(Nc*dd, shape = rgam.shape, scale = rgam.scale), 
+ 	                 nrow = Nc, ncol = dd)
&gt; component.sds &lt;- sqrt(component.vars)
&gt; 
&gt; 
&gt; # Size for each component -&gt; sample randomly for each data point from uniform distr.
&gt; # i.e. cluster assignments
&gt; sample2comp &lt;- sample.int(Nc, Ns, replace = TRUE)
&gt; 
&gt; D &lt;- array(NA, dim = c(Ns, dd))
&gt; for (i in 1:Ns)  {
+     # component identity of this sample
+     ci &lt;- sample2comp[[i]]
+     cm &lt;- component.means[ci,]
+     csd &lt;- component.sds[ci,]
+     D[i,] &lt;- rnorm(dd, mean = cm, sd = csd)
+ }
&gt; 
&gt; 
&gt; ######################################################################
&gt; 
&gt; # Fit mixture model
&gt; out &lt;- mixture.model(D, mixture.method = &quot;bic&quot;)
&gt; 
&gt; # FIXME rowmeans(qofz) is constant but not 1
&gt; #qofz &lt;- P.r.s(t(D), list(mu = out$mu, sd = out$sd, w = out$w), log = FALSE)
&gt; 
&gt; ############################################################
&gt; 
&gt; # Compare input data and results
&gt; 
&gt; ord.out &lt;- order(out$mu[,1])
&gt; ord.in &lt;- order(component.means[,1])
&gt; 
&gt; means.out &lt;- out$mu[ord.out,]
&gt; means.in &lt;- component.means[ord.in,]
&gt; 
&gt; # Cluster stds and variances
&gt; sds.out &lt;- out$sd[ord.out,]
&gt; sds.in  &lt;- sqrt(component.vars[ord.in,])
&gt; 
&gt; # -----------------------------------------------------------
&gt; 
&gt; vars.out &lt;- sds.out^2
&gt; vars.in &lt;- sds.in^2
&gt; 
&gt; # Check correspondence between input and output
&gt; if (length(means.in) == length(means.out)) {
+    cm &lt;- cor(as.vector(means.in), as.vector(means.out))
+    csd &lt;- cor(as.vector(sds.in), as.vector(sds.out))
+ }
&gt; 
&gt; # Plot results (assuming 2D)
&gt; 
&gt; ran &lt;- range(c(as.vector(means.in - 2*vars.in), 
+                as.vector(means.in + 2*vars.in), 
+ 	       as.vector(means.out + 2*vars.out), 
+ 	       as.vector(means.out - 2*vars.out)))
&gt; 
&gt; plot(D, pch = 20, main = paste(&quot;Cor.means:&quot;, round(cm,3), &quot;/ Cor.sds:&quot;, round(csd,3)), xlim = ran, ylim = ran) 
&gt; #for (ci in 1:nrow(means.out))  { add.ellipse(centroid = means.out[ci,], covmat = diag(vars.out[ci,]), col = &quot;red&quot;) }
&gt; #for (ci in 1:nrow(means.in))  { add.ellipse(centroid = means.in[ci,], covmat = diag(vars.in[ci,]), col = &quot;blue&quot;) }
&gt; 
&gt; ######################################################
&gt; 
&gt; #for (ci in 1:nrow(means.out))  {
&gt; #    points(means.out[ci,1], means.out[ci,2], col = &quot;red&quot;, pch = 19)
&gt; #    el &lt;- ellipse(matrix(c(vars.out[ci,1],0,0,vars.out[ci,2]),2), centre = means.out[ci,])
&gt; #    lines(el, col = &quot;red&quot;) 						  
&gt; #}
&gt; 
&gt; #for (ci in 1:nrow(means.in))  {
&gt; #    points(means.in[ci,1], means.in[ci,2], col = &quot;blue&quot;, pch = 19)
&gt; #    el &lt;- ellipse(matrix(c(vars.in[ci,1],0,0,vars.in[ci,2]),2), centre = means.in[ci,])
&gt; #    lines(el, col = &quot;blue&quot;) 						  
&gt; #}
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; 
&gt; proc.time()
   user  system elapsed 
  2.540   0.123   2.645 
</PRE>
</DIV><P><SPAN class="filename">netresponse.Rcheck/tests/mixture.model.test.multimodal.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.3.0 (2023-04-21) -- &quot;Already Tomorrow&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; library(netresponse)
Loading required package: BiocStyle
Loading required package: Rgraphviz
Loading required package: graph
Loading required package: BiocGenerics

Attaching package: &#x27;BiocGenerics&#x27;

The following objects are masked from &#x27;package:stats&#x27;:

    IQR, mad, sd, var, xtabs

The following objects are masked from &#x27;package:base&#x27;:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min

Loading required package: grid
Loading required package: rmarkdown

Attaching package: &#x27;rmarkdown&#x27;

The following objects are masked from &#x27;package:BiocStyle&#x27;:

    html_document, md_document, pdf_document

Loading required package: minet
Loading required package: mclust
Package &#x27;mclust&#x27; version 6.0.0
Type &#x27;citation(&quot;mclust&quot;)&#x27; for citing this R package in publications.
Loading required package: reshape2

netresponse (C) 2008-2023 Leo Lahti et al.

https://github.com/antagomir/netresponse
&gt; 
&gt; # Three MODES
&gt; 
&gt; # set.seed(34884)
&gt; set.seed(3488400)
&gt; 
&gt; Ns &lt;- 200
&gt; Nd &lt;- 2
&gt; 
&gt; D3 &lt;- rbind(matrix(rnorm(Ns*Nd, mean = 0), ncol = Nd), 
+       	    matrix(rnorm(Ns*Nd, mean = 3), ncol = Nd),
+       	    cbind(rnorm(Ns, mean = -3), rnorm(Ns, mean = 3))
+ 	    )
&gt; 
&gt; #X11()
&gt; par(mfrow = c(2,2))
&gt; for (mm in c(&quot;vdp&quot;, &quot;bic&quot;)) {
+   for (pp in c(FALSE, TRUE)) {
+ 
+     # Fit nonparametric Gaussian mixture model
+     out &lt;- mixture.model(D3, mixture.method = mm, pca.basis = pp)
+     plot(D3, col = apply(out$qofz, 1, which.max), main = paste(mm, &quot;/ pca:&quot;,  pp)) 
+ 
+   }
+ }
&gt; 
&gt; # VDP is less sensitive than BIC in detecting Gaussian modes (more
&gt; # separation between the clusters needed)
&gt; 
&gt; # pca.basis option is less important for sensitive detection but
&gt; # it will help to avoid overfitting to unimodal features that
&gt; # are not parallel to the axes (unimodal distribution often becomes
&gt; # splitted in two or more clusters in these cases)
&gt; 
&gt; 
&gt; proc.time()
   user  system elapsed 
  4.625   0.199   4.804 
</PRE>
</DIV><P><SPAN class="filename">netresponse.Rcheck/tests/mixture.model.test.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.3.0 (2023-04-21) -- &quot;Already Tomorrow&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; # Validate mixture models
&gt; 
&gt; # Generate random data from five Gaussians. 
&gt; # Detect modes 
&gt; # Plot data points and detected clusters 
&gt; 
&gt; library(netresponse)
Loading required package: BiocStyle
Loading required package: Rgraphviz
Loading required package: graph
Loading required package: BiocGenerics

Attaching package: &#x27;BiocGenerics&#x27;

The following objects are masked from &#x27;package:stats&#x27;:

    IQR, mad, sd, var, xtabs

The following objects are masked from &#x27;package:base&#x27;:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min

Loading required package: grid
Loading required package: rmarkdown

Attaching package: &#x27;rmarkdown&#x27;

The following objects are masked from &#x27;package:BiocStyle&#x27;:

    html_document, md_document, pdf_document

Loading required package: minet
Loading required package: mclust
Package &#x27;mclust&#x27; version 6.0.0
Type &#x27;citation(&quot;mclust&quot;)&#x27; for citing this R package in publications.
Loading required package: reshape2

netresponse (C) 2008-2023 Leo Lahti et al.

https://github.com/antagomir/netresponse
&gt; 
&gt; #fs &lt;- list.files(&quot;~/Rpackages/netresponse/netresponse/R/&quot;, full.names = TRUE); for (f in fs) {source(f)}; dyn.load(&quot;/home/tuli/Rpackages/netresponse/netresponse/src/netresponse.so&quot;)
&gt; 
&gt; #########  Generate DATA #######################
&gt; 
&gt; res &lt;- generate.toydata()
&gt; D &lt;- res$data
&gt; component.means &lt;- res$means
&gt; component.sds   &lt;- res$sds
&gt; sample2comp     &lt;- res$sample2comp
&gt; 
&gt; ######################################################################
&gt; 
&gt; par(mfrow = c(2,1))
&gt; 
&gt; for (mm in c(&quot;vdp&quot;, &quot;bic&quot;)) {
+ 
+   # Fit nonparametric Gaussian mixture model
+   #source(&quot;~/Rpackages/netresponse/netresponse/R/vdp.mixt.R&quot;)
+   out &lt;- mixture.model(D, mixture.method = mm, max.responses = 10, pca.basis = FALSE)
+ 
+   ############################################################
+ 
+   # Compare input data and results
+ 
+   ord.out &lt;- order(out$mu[,1])
+   ord.in &lt;- order(component.means[,1])
+ 
+   means.out &lt;- out$mu[ord.out,]
+   means.in &lt;- component.means[ord.in,]
+ 
+   # Cluster stds and variances
+   sds.out &lt;- out$sd[ord.out,]
+   vars.out &lt;- sds.out^2
+ 
+   sds.in  &lt;- component.sds[ord.in,]
+   vars.in &lt;- sds.in^2
+ 
+   # Check correspondence between input and output
+   if (length(means.in) == length(means.out)) {
+     cm &lt;- cor(as.vector(means.in), as.vector(means.out))
+     csd &lt;- cor(as.vector(sds.in), as.vector(sds.out))
+   }
+ 
+   # Plot results (assuming 2D)
+   ran &lt;- range(c(as.vector(means.in - 2*vars.in), 
+                as.vector(means.in + 2*vars.in), 
+ 	       as.vector(means.out + 2*vars.out), 
+ 	       as.vector(means.out - 2*vars.out)))
+ 
+   real.modes &lt;- sample2comp
+   obs.modes &lt;- apply(out$qofz, 1, which.max)
+ 
+   # plot(D, pch = 20, main = paste(mm, &quot;/ cor.means:&quot;, round(cm,6), &quot;/ Cor.sds:&quot;, round(csd,6)), xlim = ran, ylim = ran)
+   
+   # plot(D, pch = real.modes, col = obs.modes, main = paste(mm, &quot;/ cor.means:&quot;, round(cm,6), &quot;/ Cor.sds:&quot;, round(csd,6)), xlim = ran, ylim = ran)
+   
+   # for (ci in 1:nrow(means.out))  { add.ellipse(centroid = means.out[ci,], covmat = diag(vars.out[ci,]), col = &quot;red&quot;) }
+   # for (ci in 1:nrow(means.in))  { add.ellipse(centroid = means.in[ci,], covmat = diag(vars.in[ci,]), col = &quot;blue&quot;) }
+ 
+ }
&gt; 
&gt; 
&gt; proc.time()
   user  system elapsed 
  2.741   0.252   2.975 
</PRE>
</DIV><P><SPAN class="filename">netresponse.Rcheck/tests/mixture.model.test.singlemode.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.3.0 (2023-04-21) -- &quot;Already Tomorrow&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; 
&gt; skip &lt;- FALSE
&gt; 
&gt; if (!skip) {
+ 
+ library(netresponse)
+ 
+ # SINGLE MODE
+ 
+ # Produce test data that has full covariance
+ # It is expected that
+ # pca.basis = FALSE splits Gaussian with full covariance into two modes
+ # pca.basis = TRUE should detect just a single mode
+ 
+ Ns &lt;- 200
+ Nd &lt;- 2
+ k &lt;- 1.5
+ 
+ D2 &lt;- matrix(rnorm(Ns*Nd), ncol = Nd) %*% rbind(c(1,k), c(k,1))
+ 
+ par(mfrow = c(2,2))
+ for (mm in c(&quot;vdp&quot;, &quot;bic&quot;)) {
+   for (pp in c(FALSE, TRUE)) {
+ 
+     # Fit nonparametric Gaussian mixture model
+     out &lt;- mixture.model(D2, mixture.method = mm, pca.basis = pp)
+     plot(D2, col = apply(out$qofz, 1, which.max), main = paste(&quot;mm:&quot; , mm, &quot;/ pp:&quot;,  pp)) 
+ 
+   }
+ }
+ 
+ }
Loading required package: BiocStyle
Loading required package: Rgraphviz
Loading required package: graph
Loading required package: BiocGenerics

Attaching package: &#x27;BiocGenerics&#x27;

The following objects are masked from &#x27;package:stats&#x27;:

    IQR, mad, sd, var, xtabs

The following objects are masked from &#x27;package:base&#x27;:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min

Loading required package: grid
Loading required package: rmarkdown

Attaching package: &#x27;rmarkdown&#x27;

The following objects are masked from &#x27;package:BiocStyle&#x27;:

    html_document, md_document, pdf_document

Loading required package: minet
Loading required package: mclust
Package &#x27;mclust&#x27; version 6.0.0
Type &#x27;citation(&quot;mclust&quot;)&#x27; for citing this R package in publications.
Loading required package: reshape2

netresponse (C) 2008-2023 Leo Lahti et al.

https://github.com/antagomir/netresponse
&gt; 
&gt; proc.time()
   user  system elapsed 
  2.855   0.180   3.014 
</PRE>
</DIV><P><SPAN class="filename">netresponse.Rcheck/tests/timing.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.3.0 (2023-04-21) -- &quot;Already Tomorrow&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; 
&gt; # Play with different options and check their effect on  running times for bic and vdp 
&gt; 
&gt; skip &lt;- TRUE
&gt; 
&gt; if (!skip) {
+ 
+   Ns &lt;- 100
+   Nd &lt;- 2
+ 
+   set.seed(3488400)
+ 
+   D &lt;- cbind(
+ 
+      	rbind(matrix(rnorm(Ns*Nd, mean = 0), ncol = Nd), 
+        	      matrix(rnorm(Ns*Nd, mean = 2), ncol = Nd),
+       	      cbind(rnorm(Ns, mean = -1), rnorm(Ns, mean = 3))
+  	    ), 
+ 
+      	rbind(matrix(rnorm(Ns*Nd, mean = 0), ncol = Nd), 
+        	      matrix(rnorm(Ns*Nd, mean = 2), ncol = Nd),
+       	      cbind(rnorm(Ns, mean = -1), rnorm(Ns, mean = 3))
+  	    )
+ 	    )
+ 
+   rownames(D) &lt;- paste(&quot;R&quot;, 1:nrow(D), sep = &quot;-&quot;)
+   colnames(D) &lt;- paste(&quot;C&quot;, 1:ncol(D), sep = &quot;-&quot;)
+ 
+   ts &lt;- c()
+   for (mm in c(&quot;bic&quot;, &quot;vdp&quot;)) {
+ 
+ 
+     # NOTE: no PCA basis needed with mixture.method = &quot;bic&quot;
+     tt &lt;- system.time(detect.responses(D, verbose = TRUE, max.responses = 5, 
+ 	   		       mixture.method = mm, information.criterion = &quot;BIC&quot;, 
+ 			       merging.threshold = 0, bic.threshold = 0, pca.basis = TRUE))
+ 
+     print(paste(mm, &quot;:&quot;, round(tt[[&quot;elapsed&quot;]], 3)))
+     ts[[mm]] &lt;- tt[[&quot;elapsed&quot;]]
+   }
+ 
+    print(paste(names(ts)[[1]], &quot;/&quot;, names(ts)[[2]], &quot;: &quot;, round(ts[[1]]/ts[[2]], 3)))
+ 
+ }
&gt; 
&gt; # -&gt; VDP is much faster when sample sizes increase 
&gt; # 1000 samples -&gt; 25-fold speedup with VDP
&gt; 
&gt; 
&gt; 
&gt; proc.time()
   user  system elapsed 
  0.205   0.040   0.224 
</PRE>
</DIV><P><SPAN class="filename">netresponse.Rcheck/tests/toydata2.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.3.0 (2023-04-21) -- &quot;Already Tomorrow&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; # Generate Nc components from normal-inverseGamma prior
&gt; 
&gt; set.seed(12346)
&gt; 
&gt; Ns &lt;- 300
&gt; Nd &lt;- 2
&gt; 
&gt; # Isotropic cloud
&gt; D1 &lt;- matrix(rnorm(Ns*Nd), ncol = Nd) 
&gt; 
&gt; # Single diagonal mode
&gt; D2 &lt;- matrix(rnorm(Ns*Nd), ncol = Nd) %*% rbind(c(1,2), c(2,1)) 
&gt; 
&gt; # Two isotropic modes
&gt; D3 &lt;- rbind(matrix(rnorm(Ns/2*Nd), ncol = Nd), matrix(rnorm(Ns/2*Nd, mean = 3), ncol = Nd))
&gt; D &lt;- cbind(D1, D2, D3)
&gt; 
&gt; colnames(D) &lt;- paste(&quot;Feature-&quot;,  1:ncol(D), sep = &quot;&quot;)
&gt; rownames(D) &lt;- paste(&quot;Sample-&quot;, 1:nrow(D), sep = &quot;&quot;)
&gt; 
&gt; 
&gt; proc.time()
   user  system elapsed 
  0.195   0.050   0.227 
</PRE>
</DIV><P><SPAN class="filename">netresponse.Rcheck/tests/validate.netresponse.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.3.0 (2023-04-21) -- &quot;Already Tomorrow&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; 
&gt; skip &lt;- TRUE
&gt; 
&gt; if (!skip) {
+ 
+ # 2. netresponse test
+ # test later with varying parameters
+ 
+ # Load the package
+ library(netresponse)
+ #load(&quot;../data/toydata.rda&quot;)
+ fs &lt;- list.files(&quot;../R/&quot;, full.names = TRUE); for (f in fs) {source(f)};
+ 
+ data(toydata)
+ 
+ D &lt;- toydata$emat
+ netw &lt;- toydata$netw
+ 
+ # The toy data is random data with 10 features (genes). 
+ # The features 
+ rf &lt;- c(4, 5, 6)
+ #form a subnetwork with coherent responses
+ # with means 
+ r1 &lt;- c(0, 3, 0)
+ r2 &lt;- c(-5, 0, 2)
+ r3 &lt;- c(5, -3, -3)
+ mu.real &lt;- rbind(r1, r2, r3)
+ # real weights
+ w.real &lt;- c(70, 70, 60)/200
+ # and unit variances
+ rv &lt;- 1
+ 
+ # Fit the model
+ #res &lt;- detect.responses(D, netw, verbose = TRUE, mc.cores = 2)
+ #res &lt;- detect.responses(D, netw, verbose = TRUE, max.responses = 4)
+ 
+ res &lt;- detect.responses(D, netw, verbose = TRUE, max.responses = 3, mixture.method = &quot;bic&quot;, information.criterion = &quot;BIC&quot;, merging.threshold = 1, bic.threshold = 10, pca.basis = FALSE)
+ 
+ print(&quot;OK&quot;)
+ 
+ # Subnets (each is a list of nodes)
+ subnets &lt;- get.subnets(res)
+ 
+ # the correct subnet is retrieved in subnet number 2:
+ #&gt; subnet[[2]]
+ #[1] &quot;feat4&quot; &quot;feat5&quot; &quot;feat6&quot;
+ 
+ # how about responses
+ # Retrieve model for the subnetwork with lowest cost function value
+ # means, standard devations and weights for the components
+ if (!is.null(subnets)) {
+ m &lt;- get.model.parameters(res, subnet.id = &quot;Subnet-2&quot;)
+ 
+ # order retrieved and real response means by the first feature 
+ # (to ensure responses are listed in the same order)
+ # and compare deviation from correct solution
+ ord.obs &lt;- order(m$mu[,1])
+ ord.real &lt;- order(mu.real[,1])
+ 
+ print(paste(&quot;Correlation between real and observed responses:&quot;, cor(as.vector(m$mu[ord.obs,]), as.vector(mu.real[ord.real,]))))
+ 
+ # all real variances are 1, compare to observed ones
+ print(paste(&quot;Maximum deviation from real variances: &quot;, max(abs(rv - range(m$sd))/rv)))
+ 
+ # weights deviate somewhat, this is likely due to relatively small sample size
+ #print(&quot;Maximum deviation from real weights: &quot;)
+ #print( (w.real[ord.real] - m$w[ord.obs])/w.real[ord.real])
+ 
+ print(&quot;estimated and real mean matrices&quot;)
+ print(m$mu[ord.obs,])
+ print(mu.real[ord.real,])
+ 
+ }
+ 
+ }
&gt; 
&gt; proc.time()
   user  system elapsed 
  0.200   0.038   0.220 
</PRE>
</DIV><P><SPAN class="filename">netresponse.Rcheck/tests/vdpmixture.Rout</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<PRE style="padding: 3px;">

R version 4.3.0 (2023-04-21) -- &quot;Already Tomorrow&quot;
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: aarch64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#x27;license()&#x27; or &#x27;licence()&#x27; for distribution details.

R is a collaborative project with many contributors.
Type &#x27;contributors()&#x27; for more information and
&#x27;citation()&#x27; on how to cite R or R packages in publications.

Type &#x27;demo()&#x27; for some demos, &#x27;help()&#x27; for on-line help, or
&#x27;help.start()&#x27; for an HTML browser interface to help.
Type &#x27;q()&#x27; to quit R.

&gt; 
&gt; # 1. vdp.mixt: moodien loytyminen eri dimensiolla, naytemaarilla ja komponenteilla
&gt; #   -&gt; ainakin nopea check
&gt; 
&gt; #######################################################################
&gt; 
&gt; # Generate random data from five Gaussians. 
&gt; # Detect modes with vdp-gm. 
&gt; # Plot data points and detected clusters with variance ellipses
&gt; 
&gt; #######################################################################
&gt; 
&gt; library(netresponse)
Loading required package: BiocStyle
Loading required package: Rgraphviz
Loading required package: graph
Loading required package: BiocGenerics

Attaching package: &#x27;BiocGenerics&#x27;

The following objects are masked from &#x27;package:stats&#x27;:

    IQR, mad, sd, var, xtabs

The following objects are masked from &#x27;package:base&#x27;:

    Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,
    as.data.frame, basename, cbind, colnames, dirname, do.call,
    duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted,
    lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin,
    pmin.int, rank, rbind, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unsplit, which.max, which.min

Loading required package: grid
Loading required package: rmarkdown

Attaching package: &#x27;rmarkdown&#x27;

The following objects are masked from &#x27;package:BiocStyle&#x27;:

    html_document, md_document, pdf_document

Loading required package: minet
Loading required package: mclust
Package &#x27;mclust&#x27; version 6.0.0
Type &#x27;citation(&quot;mclust&quot;)&#x27; for citing this R package in publications.
Loading required package: reshape2

netresponse (C) 2008-2023 Leo Lahti et al.

https://github.com/antagomir/netresponse
&gt; #source(&quot;~/Rpackages/netresponse/netresponse/R/detect.responses.R&quot;)
&gt; #source(&quot;~/Rpackages/netresponse/netresponse/R/internals.R&quot;)
&gt; #source(&quot;~/Rpackages/netresponse/netresponse/R/vdp.mixt.R&quot;)
&gt; #dyn.load(&quot;/home/tuli/Rpackages/netresponse/netresponse/src/netresponse.so&quot;)
&gt; 
&gt; 
&gt; #########  Generate DATA #############################################
&gt; 
&gt; res &lt;- generate.toydata()
&gt; D &lt;- res$data
&gt; component.means &lt;- res$means
&gt; component.sds   &lt;- res$sds
&gt; sample2comp     &lt;- res$sample2comp
&gt; 
&gt; ######################################################################
&gt; 
&gt; # Fit nonparametric Gaussian mixture model
&gt; out &lt;- vdp.mixt(D)
&gt; # out &lt;- vdp.mixt(D, c.max = 3) # try with limited number of components -&gt; OK
&gt; 
&gt; ############################################################
&gt; 
&gt; # Compare input data and results
&gt; 
&gt; ord.out &lt;- order(out$posterior$centroids[,1])
&gt; ord.in &lt;- order(component.means[,1])
&gt; 
&gt; means.out &lt;- out$posterior$centroids[ord.out,]
&gt; means.in &lt;- component.means[ord.in,]
&gt; 
&gt; # Cluster stds and variances
&gt; sds.out &lt;- out$posterior$sds[ord.out,]
&gt; sds.in  &lt;- component.sds[ord.in,]
&gt; vars.out &lt;- sds.out^2
&gt; vars.in &lt;- sds.in^2
&gt; 
&gt; # Check correspondence between input and output
&gt; if (length(means.in) == length(means.out)) {
+    cm &lt;- cor(as.vector(means.in), as.vector(means.out))
+    csd &lt;- cor(as.vector(sds.in), as.vector(sds.out))
+ }
&gt; 
&gt; # Plot results (assuming 2D)
&gt; 
&gt; ran &lt;- range(c(as.vector(means.in - 2*vars.in), 
+                as.vector(means.in + 2*vars.in), 
+ 	       as.vector(means.out + 2*vars.out), 
+ 	       as.vector(means.out - 2*vars.out)))
&gt; 
&gt; #plot(D, pch = 20, main = paste(&quot;Cor.means:&quot;, round(cm,3), &quot;/ Cor.sds:&quot;, round(csd,3)), xlim = ran, ylim = ran) 
&gt; #for (ci in 1:nrow(means.out))  { add.ellipse(centroid = means.out[ci,], covmat = diag(vars.out[ci,]), col = &quot;red&quot;) }
&gt; #for (ci in 1:nrow(means.in))  { add.ellipse(centroid = means.in[ci,], covmat = diag(vars.in[ci,]), col = &quot;blue&quot;) }
&gt; 
&gt; 
&gt; 
&gt; proc.time()
   user  system elapsed 
  2.359   0.171   2.510 
</PRE>
</DIV><HR>
<H3>Example timings</H3>
<P><SPAN class="filename">netresponse.Rcheck/netresponse-Ex.timings</SPAN></P>
<DIV class="kunpeng1 hscrollable">
<TABLE>
<TR><TD>name</TD><TD style="text-align: right;">user</TD><TD style="text-align: right;">system</TD><TD style="text-align: right;">elapsed
</TD><TR>
<TR><TD>NetResponseModel-class</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>PlotMixture</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>PlotMixtureBivariate</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>PlotMixtureMultivariate</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>PlotMixtureUnivariate</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>centerData</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>check.matrix</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>check.network</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>continuous.responses</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>detect.responses</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>dna</TD><TD style="text-align: right;">0.017</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">0.019</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>enrichment.list.factor</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>enrichment.list.factor.minimal</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>factor.responses</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>factor.responses.minimal</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>filter.network</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>find.similar.features</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.003</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>generate.toydata</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.003</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>get.dat-NetResponseModel-method</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>get.model.parameters</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">0.004</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>get.subnets-NetResponseModel-method</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>getqofz-NetResponseModel-method</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>independent.models</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>list.responses.continuous.multi</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>list.responses.continuous.single</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>list.significant.responses</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>listify.groupings</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>mixture.model</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>model.stats</TD><TD style="text-align: right;">0.003</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.003</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>netresponse-package</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>order.responses</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>osmo</TD><TD style="text-align: right;">0.031</TD><TD style="text-align: right;">0.003</TD><TD style="text-align: right;">0.035</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>pick.model.pairs</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>pick.model.parameters</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>plotPCA</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>plot_associations</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>plot_data</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>plot_expression</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>plot_matrix</TD><TD style="text-align: right;">0.009</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.012</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>plot_response</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>plot_responses</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>plot_scale</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>plot_subnet</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>read.sif</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>remove.negative.edges</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>response.enrichment</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>response2sample</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.004</TD><TD style="text-align: right;">0.005</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>sample2response</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>set.breaks</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.001</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>toydata</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">0.000</TD><TD style="text-align: right;">0.002</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>update.model.pair</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>vdp.mixt</TD><TD style="text-align: right;">0.040</TD><TD style="text-align: right;">0.019</TD><TD style="text-align: right;">0.060</TD><TD style="text-align: right;">
</TD><TR>
<TR><TD>vectorize.groupings</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">0</TD><TD style="text-align: right;">
</TD><TR>
</TABLE>
</DIV></BODY>
</HTML>
